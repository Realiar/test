\input{pcsmacros}

\pgfdeclareimage[height=1.0in]{logo}{Fig/kaust}

\title[]{Writing a paper}
\subtitle{using Madagascar}
\author{Tariq Alkhalifah} 
\institute{
Seismic Analysis Group (SWAG) \\
KAUST \\
swag.kaust.edu.sa
}
\date{}
%\logo{Fig/swag_logo}
% ------------------------------------------------------------
\mode<beamer> { \cwpcover }

\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqa{\begin{eqnarray}}
\def\eeqa{\end{eqnarray}}

% ------------------------------------------------------------
\inputdir{XFig}
% ------------------------------------------------------------

\begin{frame} 
\frametitle{From the net}

\big{
Q: What is the difference between a Ph.D. in mathematics and a large pizza?
A: A large pizza can feed a family of four... 
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Top 10 reasons why Professor Sergey called this package Madagascar}

\begin{itemize}
\item 10. He was in Madagascar, so he said what the heck.
\item 9. The only country he did not travel to.
\item 8. All the vowels are ``a'', which made it easier to spell.
\item 7. It is the only country he could spell.
\item 6. If you break it down ``Mad'' ``a'' ``gas'' ``car'', related
  to the Oil industry.
\item .........
\end{itemize}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Writing papers, what will we learn?}

\big{
\begin{itemize}
\item Use Madagascar to write papers.
\item The template concept.
\item The scons role.
\item Reproducible.
\item The book (file system).
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Challenges}

\big{
The seemingly complex makeup:
\begin{itemize}
\item LaTeX, python (scons????), and C.
\item The file system (where is everything?).
\item incomplete and not-up-to-date documentation.
\item Any info on the libraries? (C and Python)?
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{A general objective}

\big{
\begin{itemize}
\item Getting from Madagascar what you need: even if we have to get dirty.
\item Example subject: Traveltime sensitivity kernels 
\end{itemize}
}

\end{frame}
\cwpnote{}

\begin{frame}
  \frametitle{The Big Scheme of Things}
  \includegraphics[height=0.8\textheight]{XFig/Fig/scheme} \\
Courtesy of Fomel (2006)
\end{frame}

\begin{frame}
  \frametitle{The Big Scheme of Things II}
  \includegraphics[height=0.8\textheight]{XFig/Fig/scheme2} \\
Courtesy of Fomel (2006)
\end{frame}

\begin{frame}
  \frametitle{{\LaTeX}}
\big{
 \begin{itemize}
    \item Documentation system  
    \item Extends \TeX
    \begin{itemize}
    \item ``Open source''
    \item ``Reproducible''
   \end{itemize}
\item Descriptive language
    \end{itemize}
}
\end{frame}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{The essential tool}

\big{
LeTeX and specifically SEGTeX macros including SEG.bib \\
\begin{itemize}
\item article class.
\item Geophysics class.
\item segabs.cls for SEG abstracts.
\end{itemize}
}
downloading: svn co \url{https://segtex.svn.sourceforge.net/svnroot/segtex/trunk texmf}

\end{frame}
\cwpnote{}


\begin{frame}
  \frametitle{SEGTeX}
  \begin{itemize}
  \item {\LaTeX2e} package
  \item In development 2001--Present
  \item {\color{blue}{\url{http://reproducibility.org/wiki/Main_Page}}}
  \item Multiple purpose
    \begin{itemize}
    \item \emph{Geophysics} papers
    \begin{itemize}
    \item Manuscript style
    \item Publication style 
    \end{itemize}
    \item SEG expanded abstracts
    \item Other
    \begin{itemize}
    \item books and reports
    \item EAGE publications
    \item presentations
     \end{itemize}
    \end{itemize}
   \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Look Inside SEGTeX}
  \begin{itemize}
  \item \texttt{texmf/}
    \begin{itemize}
    \item \texttt{ls-R} (update with \texttt{texconfig rehash}) 
    \item \texttt{tex/latex/seg/}

    \begin{itemize}
    \item \texttt{geophysics.dtx} (literate programming)
    \item \texttt{geophysics.cls}
    \item \texttt{seg.sty}
    \item $\cdots$
    \end{itemize}

    \item \texttt{bibtex/bst/seg/}

     \begin{itemize}
    \item \texttt{seg.bst}
    \item \texttt{seglike.bst} (Joerg Schleicher)
    \end{itemize}

    \item \texttt{bibtex/bib/seg/}

    \begin{itemize}
    \item \texttt{SEG2005.bib}
    \item \texttt{SEG.bib}
    \end{itemize}

    \item {\texttt{latex2html/}}
    
    \begin{itemize}
    \item \texttt{perl/geophysics.perl}
    \item \texttt{icons/}
    \item \texttt{style.css}
    \end{itemize}

    \end{itemize}    
  \end{itemize}
\end{frame}


% ------------------------------------------------------------
%\begin{frame} 
%
%\frametitle{Installation}
%
%\big{
%\begin{itemize}
%\item Put the contents of the texmf folder where LaTeX can find it
%  (i.e. \$HOME/texmf or specifically \$HOME/texmf/tex/latex)
%\item Run texhash or texconfig.
%\end{itemize}
%}
%
%\end{frame}
%\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Where are the live papers?}

\big{In the Madagascar file system: \\
RSFSRC/book \\
$\overbrace{\text{book}}^{main}/\overbrace{\text{sep}}^{group}/\overbrace{\text{banana}}^{paper}/\overbrace{\text{kernel}}^{examples}/\overbrace{\text{Fig}}^{Figures}$
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Paper directory}

\big{
\begin{itemize}
\item paper.tex, paper.bib, SConstruct
\item Fig directory: static plots
\item XFig directory: plots drawn using xfig
\item Math directory: examples using mathematica or matlab
\item marm directory: example using the Marmousi model
\end{itemize}
}

\end{frame}
\cwpnote{}



% ------------------------------------------------------------
\begin{frame} 

\frametitle{Paper: the example subject}

\big{The sensitivity of traveltimes to velocity changes based on (high frequency) rays and (finite frequency) fat rays.}

\end{frame}
\cwpnote{}


\inputdir{kernel}
% ------------------------------------------------------------
\begin{frame} \frametitle{For a ray: the high frequency limit}

\plot{RayKernel}{width=0.9\textwidth}{}
Courtesy of Rickett (2000)
 \end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{At 30 Hz}

\plot{BananaPancake8}{width=0.9\textwidth}{}
Courtesy of Rickett (2000)
 \end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{At 120 Hz}

\plot{BananaPancake2}{width=0.9\textwidth}{}
Courtesy of Rickett (2000)
 \end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Paper: scope}

\big{
\begin{itemize}
   \item Finite frequency traveltimes
   \item Modify paper and develop equations
   \item A simple example
   \item Application to the Marmousi example
\end{itemize}
}

\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame} \frametitle{The paper template: a Madagascar feature}

\begin{itemize}
   \item From the book directory, or one of your own papers
   \item Read the paper and see if you could form a good introduction
     from that paper.
   \item Copy it to your directory compile it (the whole directory)
   \item Remove unwanted examples and corresponding directories (compile again).
   \item Write your abstract (a road map).
\end{itemize}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{For the sensitivity kernels} 

\big{
``Traveltime sensitivity kernels: Banana-doughnuts or just
plain bananas?''
}
\big{James Rickett}

\big{RSFSRC/book/sep/banana}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Perturbation theory}

\big{
\begin{equation}
{\bf \delta T} = {\bf A \; \delta S} \nonumber
\end{equation}
${\bf \delta T}$ traveltime perturbations \\
${\bf \delta S}$ slowness perturbations \\
${\bf A}$ modeling operator
\begin{equation}\label{eqn:tomoray}
\delta T=\int_{\rm ray} \delta s({\bf x}) \;dl \nonumber
\end{equation}
}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Born-based traveltime}

\big{
\begin{equation} \label{eqn:timeshift}
\delta T = 
\frac{\int_{t_1}^{t_2} {\dot U}(t) \; \delta U(t) \; dt}
{\int_{t_1}^{t_2} {\ddot U}(t) \; U(t) \; dt} \nonumber
\end{equation}
}
courtesy of Marquering et al. (1999)
\begin{equation}\label{eqn:born}
\delta U_{\rm Born}({\bf x},\omega)=\frac{\omega^2}{4 \pi}
\int_V G_0({\bf x},\omega; {\bf x}')\,U_0({\bf x},\omega; {\bf x}')
\delta s({\bf x}') dV({\bf x}') \nonumber
\end{equation}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Rytov traveltime}

\big{
\begin{eqnarray}
{\bf \delta T} = \sum_\omega \frac{F(\omega)}{\omega} \;
\Im \left({\bf \delta \Psi}\right) \nonumber \\
= \sum_\omega \frac{F(\omega)}{\omega} 
\;\Im \left( {\bf R \; \delta S}\right) \nonumber
\end{eqnarray}
\begin{equation} 
\delta \psi_{\rm Rytov} ({\bf x},\omega)  = 
\frac{\delta U_{\rm Born}({\bf x},\omega)}{U_0({\bf x},\omega)} \nonumber
\end{equation}
}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Getting started}
\vspace{-.6in}
\big{\begin{itemize}
\item Copy the directory ``book/sep/banana'' to your desired location
\item cp -r book/sep/banana ~/.
\item Change directory name (i.e. doughnut)
\item enter the directory
\item Compile the paper: ``sftour scons lock'' and then ``scons read''
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Compiling options}

\big{\begin{itemize}
\item scons paper.read
\item scons paper.pdf
\item scons paper.html
\item scons paper.wiki
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{The paper SConstruct}

\big{SConstruct}
\normalsize 
\lstinputlisting[firstline=1,lastline=12]
		{SConstruct}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Make a change: reproducible?}

\big{\begin{itemize}
\item Look at the paper
\item Access its tex version
\item and especially the Figures
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{paper.tex}

\normalsize 
\lstinputlisting[firstline=1,lastline=15]
		{paper.tex}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{paper.tex}

\big{The Figures directory}
\normalsize 
\lstinputlisting[firstline=189,lastline=194]
		{paper.tex}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{paper.tex}

\big{Calling the Figure}
\normalsize 
\lstinputlisting[firstline=203,lastline=210]
		{paper.tex}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Make a change: reproducible?}

\big{\begin{itemize}
\item Enter directory ``kernel''
\item Open SConstruct using your favorite editor
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{The example SConstruct}

\big{kernel/SConstruct}
\normalsize 
\lstinputlisting[firstline=1,lastline=12]
		{kernel/SConstruct}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Use Born instead of Rytov}

\big{kernel/SConstruct}
\normalsize 
\lstinputlisting[firstline=25,lastline=32]
		{kernel/SConstruct}

\big{code name: sfsensitivity}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications}

\big{
\begin{itemize}
   \item Change 6 to 2 using your favorite editor
   \item scons view
   \item scons lock
   \item cd ..; scons read
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Adopting the paper}
\vspace{-.6in}
\big{
\begin{itemize}
   \item Insert new title
   \item Modify author(s)
   \item Change introduction to your language, use references and add this paper as
     a reference ``banana.bib''
   \item Clean the rest, keep one Figure
   \item start writing your own paper
  \item remove examples if not needed
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Adding synthetic examples}
\vspace{-.6in}
\big{
\begin{itemize}
   \item Directory ``RSFSRC/book/data'' or any other paper running an
     example
   \item Copy the example to your paper directory (i.e. \$RSFSRC/book/swag/eikds/smvel)
   \item cd smvel; scons view; scons lock
   \item This forms a start, clean it up and add your code example
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Including the new example}
\vspace{-.6in}
\big{
\begin{itemize}
   \item cd ..
   \item Open paper.tex with you favorite editor
   \item Above the plot call type: \\inputdir\{smvel\}
   \item Insert the Figure name inside the Plot function
   \item modify the caption
   \item reference the Figure in a sentence
   \item Save and compile; scons read
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{More info}

\big{
\begin{itemize}
   \item \url{http://www.reproducibility.org/wiki/SEGTeX\#Documentation}
   \item \$RSFSRC/book/rsf
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Tips and tricks }

\big{
\begin{itemize}
   \item Be patient, do not give up
   \item Use rsf-user@lists.sourceforge.net
   \item SConstruct controls everything, try, at least, to understand
   \item Always access other papers with the power of ``grep''
\end{itemize}
}

\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame} \frametitle{Reproducible papers }

\url{http://www.reproducibility.org/wiki/Reproducible_Documents}
\url{http://www.reproducibility.org/RSF/book/sep/banana/paper_html/}

\begin{itemize}
   \item Source: \$RSFSRC/book/sep/banana
\end{itemize}

\end{frame}
\cwpnote{}

\inputdir{.}

% ------------------------------------------------------------
\begin{frame} \frametitle{Documentation}

\big{
Madagascar Programming Reference Manual}
\big{courtesy of SWAG}
\big{RSFSRC/book/rsf/manual}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Content}

\begin{itemize}
   \item Covers all available data types and subroutines under rsf.h
   \item Includes a description (beyond what was given by the developer)
   \item It organizes them in terms of usage and purpose
   \item we plan to have the manual get built automatically to include
     updates in the subroutine
 \item \$RSFSRC/book/rsf/manual
\end{itemize}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Content}\
\vspace{-0.2in}

\begin{itemize}
\item \emph{An example: Finite-Difference modeling}
\item \emph{Data types}\label{sec:datatypes}
\item \emph{Preparing for input}\label{sec:input}
\item \emph{Operations with RSF files}\label{sec:files}
\item \emph{Error handling}\label{sec:error}
\item \emph{Linear operators}\label{sec:lop}
\item \emph{Data analysis}\label{sec:analysis}
\item \emph{Filtering}\label{sec:filter}
\item \emph{Solvers}\label{sec:solvers}
\item \emph{Interpolation}\label{sec:interpolation}
\item \emph{Smoothing}\label{sec:smoothing}
\item \emph{Ray tracing}\label{sec:ray}
\item \emph{General tools}\label{sec:general}
\item \emph{Geometry}\label{sec:geometry}
\item \emph{Miscellaneous}\label{sec:misc}
\item \emph{System}\label{sec:system}
\end{itemize}
\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame} \frametitle{Pointers}

\big{
\begin{itemize}
   \item Be patient, do not give up
   \item Use rsf-user@lists.sourceforge.net
   \item SConstruct controls everything, try, at least, to understand it
   \item You could always run RSF like SU
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Final remarks}

\big{
\begin{itemize}
   \item Make things simple
   \item Get to know Madagascar, it can be your friend, but hopefully
     not your only friend
   \item Always compile (makes error search easier)
   \item Reproducible is good (very good)
   \item Love thy neighbor $\rightarrow$ contribute
\end{itemize}
}

\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame}

\big{I thank the supporters of SWAG}

\vfill

\begin{center}
\plot{swag_logo}{width=0.3\textwidth}{}
%\pgfuseimage{../Fig/swag_logo}
\end{center}

\big{\url{http://swag.kaust.edu.sa}}

\end{frame}

\cwpnote{}


%% 
 % contest: nicest impulse response at z=7km, x=14km
 % beauty: 1...100 (nicest image, i.e. fewest artifacts)
 % cost:   1...100 (highest cost, i.e. most receivers)
 % find the highest b/c score
 %%
