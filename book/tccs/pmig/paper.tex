\published{Geophysics, 72, no. 3, S139-S147, (2007)}
\title{Velocity-independent time-domain seismic imaging \\ using
local event slopes}

%\ms{GEO-2006-0415}

\lefthead{Fomel}
\righthead{Seismic imaging using local event slopes}

\author{Sergey Fomel}
\address{Bureau of Economic Geology, \\
John A. and Katherine G. Jackson School of Geosciences \\
The University of Texas at Austin \\
University Station, Box X \\
Austin, TX 78713-8972}

\maketitle

\begin{abstract}
  I show that, by estimating local event slopes in prestack seismic
  reflection data, it is possible to accomplish all common time-domain
  imaging tasks, from normal moveout to prestack time migration,
  without the need to estimate seismic velocities or any other
  attributes. Local slopes contain complete information about the
  reflection geometry. Once they are estimated, seismic velocities and
  all other moveout parameters turn into data attributes and are
  directly mappable from the prestack data domain into the
  time-migrated image domain. I develop an analytical theory for this
  method and demonstrate its applicability on synthetic and field data
  examples.
\end{abstract}

\section{Introduction}

The conventional approach to seismic data analysis \cite[]{yilmaz}
consists of two main steps: estimating seismic velocities (the
subsurface macromodel) and seismic imaging (mapping of the reflected
seismic energy to the reflector positions). The two steps can be
repeated when the velocity model gets refined by imaging. 
Estimating velocities remains one of the most
labor-intensive and time-consuming tasks in seismic data processing
although several approaches have been developed to partially automate
and simplify it \cite[]{SEG-1999-11621165,SEG-2003-20882091,lambare2}.
%\cite{GEO66-06-16991713} suggest scanning different constant
%velocities for automatic picking of the migration velocity field. Analogous
%scanning was previously considered by %\cite{shurtleff},
%\cite{Fowler.sepphd.58} %, and \cite{GEO57-01-00510059} 
%and can be accomplished efficiently using velocity continuation
%\cite[]{GEO68-05-16621672}.
%\cite{landa} goes further by suggesting that
%uncertainty in velocity picking can be used for enhancing seismic imaging.
In time-domain imaging, effective seismic velocities are picked from
semblance scans. More than just a single parameter (such as seismic
velocity) needs to be picked to use higher-order traveltime
approximations such as those suggested by the multifocusing approach
\cite[]{gelchinsky,crs}.

The idea of \emph{velocity-independent time-domain seismic imaging} belongs to
\cite{Ottolini.sep.37.59}, who considered decomposing seismic data into a
range of local slopes. \old{Recently,} \cite{wolf} 
% and \cite{guitton} 
\old{have} observed
that it is possible to perform moveout analysis by estimating local data
slopes in the prestack data domain using an automatic method such as
plane-wave destruction \cite[]{GEO67-06-19461960}.  In this paper, I extend
Ottolini's idea of velocity-independent imaging and show that extracting local
event slopes in prestack data is sufficient for accomplishing all common
time-domain imaging tasks, from hyperbolic and non-hyperbolic normal moveout
corrections to dip moveout and prestack time migration. Rather than being a
prerequisite for seismic imaging, seismic velocities turn into data attributes
that can be extracted from the input data simultaneously with imaging.

The idea of using local event slopes estimated from prestack \new{seismic}
data goes back to the work of \cite{GEO01-01-00970106} and
\cite{riabinkin}. It was used later by \cite{Sword.sepphd.55} and
extended in the method of stereotomography
\cite[]{billette,GEO68-03-10081021,lambare,SEG-2004-23672370}.  In the
depth imaging context, local data slopes were \new{also utilized by
\cite{SEG-2003-11301133} for anti-aliased Kirchhoff migration} and by
\cite{GEO68-03-10431051} in the method of parsimonious depth
migration. In this paper, I extend and formalize the application of
these ideas to time-domain imaging. By analogy with the oriented wave
equation, which describes wave propagation in the space of local
orientations \cite[]{SEG-2003-08930898}, I use the term
\emph{oriented} when referring to local slopes.

The analysis proceeds from normal moveout (NMO) to dip moveout (DMO)
and prestack time migration. I derive analytical expressions for
mapping the data attributes to the imaging domain and demonstrate
their use with synthetic and field data tests.

\section{Oriented time-domain imaging}

Let us start with a simple hyperbolic moveout correction and then
consider a progression of time-domain imaging operators with
increasing complexity.

\subsection{Normal moveout}

\inputdir{nmo}

Let us consider the classic hyperbolic model of reflection moveout:
\begin{equation}
  \label{eq:nmo}
  t(l) = \sqrt{t_0^2 + \frac{l^2}{v_n^2(t_0)}}\;,
\end{equation}
where $t_0$ is the zero-offset traveltime, $t(l)$ is the corresponding
traveltime recorded at offset $l$, and $v_n(t_0)$ is the stacking or
RMS velocity. As follows from equation~\ref{eq:nmo}, the traveltime slope $p= d t/d l$ is given by 
\begin{equation}
  {p} = {\frac{l}{t\,v_n^2(t_0)}}\;.
  \label{eq:pnmo}
\end{equation}
Knowing the local slope $p(t,l)$ in a common-midpoint gather, one can
effectively eliminate the velocity $v(t_0)$ from
equations~\ref{eq:nmo} and~\ref{eq:pnmo} arriving at the
velocity-independent moveout equation \cite[]{Ottolini.sep.37.59}
\begin{equation}
  \label{eq:nmo2}
  t_0 = \sqrt{t^2 - t\,p(t,l)\,l}\;.
\end{equation}
Equation~\ref{eq:nmo2} describes a direct mapping from prestack data
to the zero-offset time. This equation constitutes an \emph{oriented
normal moveout} correction. As follows from equation~\ref{eq:pnmo},
the velocity is mapped as follows:
\begin{equation}
  {\frac{1}{v_n^2}} = p(t,l)\,{\frac{t}{l}}\;. 
  \label{eq:vnmo}
\end{equation}
Unlike its role in the conventional normal moveout (NMO), velocity is
not a requirement for the moveout correction but \old{it is}
\new{rather} a data attribute derived from the local slopes and mappable
directly to the appropriate zero-offset time.

A simple synthetic example is shown in Figure~\ref{fig:synt}. The
synthetic data (Figure~\ref{fig:synt}a) were generated by applying
inverse NMO with time-variable velocity and represent perfectly
hyperbolic events. Figure~\ref{fig:synt}b shows local event slopes
measured from the data using the plane-wave destruction algorithm of
\cite{GEO67-06-19461960}. Plane-wave destruction
\cite[]{Claerbout.blackwell.92} works by making a prediction of each
seismic trace from the neighboring trace along local slopes and then
minimizing the prediction error by an iterative regularized
least-squares optimization. Regularization controls smoothness of the
estimated slope field. In this work, I use shaping regularization
\cite[]{shape} for an optimal smoothness control.
Figure~\ref{fig:synt}c shows the output of oriented NMO using
equation~\ref{eq:nmo2}. As expected, \old{the} \new{all} events are
perfectly flattened after NMO.

\plot{synt}{width=\columnwidth}{a: A synthetic CMP gather composed of
  hyperbolas. b: Estimated local event slopes. c: The output of
  oriented velocity-independent NMO.}

In conventional NMO processing, one scans a number of velocities,
performs the corresponding number of moveout corrections, and picks
the velocity trend from velocity spectra. In oriented processing,
velocity becomes, according to equation~\ref{eq:vnmo}, a data
attribute rather than a prerequisite for
imaging. Figure~\ref{fig:svsc} shows a comparison between velocity
spectra used for picking velocities in the conventional NMO processing
and the velocity attribute mapped directly from the data space using
equations~\ref{eq:nmo2} and~\ref{eq:vnmo}. A noticeably higher
resolution of the oriented map follows from the fact that only the
true signal slopes are identified by the slope estimation algorithm.
\new{The slope uncertainty, unlike the velocity uncertainty,
is not taken into account}.

\plot{svsc}{width=\columnwidth}{a: Velocity spectra using conventional
velocity scanning. In the conventional NMO processing, the velocity
trend is picked from velocity spectra prior to NMO. b: Velocity mapped
from the data space using oriented NMO. The input for both plots is
the synthetic CMP gather shown in 
Figure~\ref{fig:synt}a. The red line indicates the exact
velocity used for generating the synthetic data.}

\inputdir{mig}

Figure~\ref{fig:pnmo} shows a field data example. The data are taken
from a historic Gulf of Mexico dataset \cite[]{bei}. Analogously to
the synthetic case, a CMP gather (Figure~\ref{fig:pnmo}a) is properly
flattened (Figure~\ref{fig:pnmo}c) by an application of oriented NMO
using the local event slopes (Figure~\ref{fig:pnmo}b) measured
directly from the data. A comparison between conventional velocity
spectra and the velocity mapping with oriented NMO is shown in
Figure~\ref{fig:bvsc}. Again, a significantly higher resolution is
observed.

\plot{pnmo}{width=\columnwidth}{a: A CMP gather from the Gulf of
  Mexico. b: estimated local event slopes. c: the output of
  oriented velocity-independent NMO.}

\plot{bvsc}{width=\columnwidth}{a: Velocity spectra using conventional
velocity scanning. In the conventional NMO processing, the velocity
trend is picked from velocity spectra prior to NMO. b: Velocity mapped
from the data space using oriented NMO. The input for both plots is
the CMP gather shown in Figure~\ref{fig:pnmo}a. The red curve is an
automatic pick of the velocity trend shown for comparison.}

\subsection{$\tau$-$p$ NMO}

\new{One can choose to perform normal moveout in the slant-stack
  ($\tau$-$p$) domain rather than the original $t$-$x$ domain.}  In
  the $\tau$-$p$ domain, hyperbolas turn into ellipses but the moveout
  correction problem remains
  \cite[]{GEO46-03-02550267}. Differentiating the $\tau$-$p$ moveout
  equation
\begin{equation}
  \label{eq:taup}
  \tau(p) = \tau_0\,\sqrt{1 - p^2\,v_n^2(\tau_0)}\;
\end{equation}
\old{we obtain} \new{leads to}
\begin{equation}
  r = {\frac{d \tau}{d p}} = - {\frac{p\,v_n^2(\tau_0)\,\tau_0^2}{\tau}}\;,
  \label{eq:dtaup}
\end{equation}
which resolves in the oriented velocity-free moveout equation analogous to
equation~\ref{eq:nmo2}
\begin{equation}
  \label{eq:taupmo}
  \tau_0 = \sqrt{\tau^2 - \tau\,r(\tau,p)\,p}\;.
\end{equation}
\new{Combining equations~\ref{eq:taup} and~\ref{eq:taupmo} produces} the
corresponding velocity mapping equation \old{is}
\begin{equation}
  \label{eq:taupvel}
  v_n^2 = \frac{r(\tau,p)}{p^2\,r(\tau,p) - p\,\tau}\;.
\end{equation}

\subsection{Non-hyperbolic \old{NMO} \new{moveout}}

\nocite{Sword.sep.51.313}

The hyperbolic model~\ref{eq:nmo} is not accurate at large offsets in the
case of non-hyperbolic moveouts, caused by vertical or lateral heterogeneity,
reflector curvature, or anisotropy \cite[]{grechka}. One popular model for
describing non-hyperbolic moveouts was developed by \cite{ussr} and has the
form of a shifted hyperbola
\cite[]{GEO53-02-01430157,GEO59-06-09830999,SEG-2000-22452248}
\begin{equation}
  \label{eq:malov}
  t(l) = t_0\,\left(1-\frac{1}{S(t_0)}\right) + 
  \frac{1}{S(t_0)}\sqrt{t_0^2 + S(t_0)\,\frac{l^2}{v_n^2(t_0)}}\;,
\end{equation}
Equation~\ref{eq:malov} contains an additional parameter $S$, which
is related to heterogeneity and anisotropy of seismic velocities. We
can eliminate this parameter by differentiating the equation twice and
defining the second derivative $q = \partial p/\partial l = \partial^2
t/ \partial l^2$. 
Eliminating both $v_n$ and $S$ from equation~\ref{eq:malov} and \old{the
corresponding} equations \old{for $p$ and $q$,}
\begin{eqnarray}
  \label{eq:pn}
  p & = & \frac{l}{\left[t_0 + S(t_0)\,\left(t-t_0\right)\right]\,v_n^2}\;, \\
  \label{eq:qn}
  q & = & \frac{t_0^2}{\left[t_0 + S(t_0)\,\left(t-t_0\right)\right]^3\,v_n^2}\; 
\end{eqnarray}
\old{we can write a} \new{leads to the}
velocity-independent non-hyperbolic \old{NMO} \new{moveout} equation \old{as}
\begin{equation}
  t_0 = t - \frac{p\,l}{1 + \sqrt{\frac{q\,l}{p}}}\;.
\end{equation}
If \old{the} moveout parameters $v_n$ and $S$ are required for subsequent
interpretation, one can easily extract them as special data attributes
\begin{eqnarray}
  \frac{1}{v_n^2} & = & t_0\,\sqrt{\frac{p^3}{q\,l^3}}\;, \\
  S & = & 1 + \frac{p\,(t - p\,l) - q\,l\,t}{\sqrt{q\,p^3\,l^3}}\;.
\end{eqnarray}
One could estimate the function $q(t,l)$ in practice by numerically
differentiating the local slope field $p(t,l)$.

\subsection{Dix inversion}
Not only moveout velocities but also interval velocities can be
estimated by using the local slope information. 
Employing the Dix inversion approach \cite[]{GEO20-01-00680086}
and defining $p_t = \partial p/\partial t$, one can deduce from
equations~\ref{eq:nmo2} and~\ref{eq:vnmo} an expression for the
interval velocity $v_i$, which becomes another attribute directly
mappable from the data, as follows:
\begin{equation}
  \label{eq:vi}
  v_i^2 = %\frac{d}{d\,t_0}\,\left[t_0\,v^2(t_0)\right] =
  \frac{l}{p^2\,t}\,
  \frac{p\,l (p + t\,p_t) - 2 p_t\,t^2}{2\,t - l\,(p + t\,p_t)}\;.
\end{equation}
Equation~\ref{eq:vi} shows that then the interval velocity can be
regarded as another attribute mappable directly from the data. The
derivation is detailed in Appendix A.

Figure~\ref{fig:svin} shows the interval velocity mapping according to
equation~\ref{eq:vi} for the synthetic data example shown in
Figure~\ref{fig:synt}a. The exact interval velocity profile (red
curve) is recovered perfectly. An analogous example for the field
dataset from Figure~\ref{fig:pnmo} is shown in
Figure~\ref{fig:bvint}. The field data result is noisy because of the
instability of numerical differentiation but \old{it} \new{clearly}
shows \old{clearly} the overall range of interval velocities.

Equation~\ref{eq:vi} enables direct mapping from data slope attributes
into interval velocities. Thus, it provides an analytical solution to
the stereotomography problem \cite[]{billette}
for the special case of
horizontal reflection layers and vertically variable velocities.

\inputdir{nmo}

\plot{svin}{width=\columnwidth}{Oriented mapping to interval velocity
for the synthetic data set shown in Figure~\ref{fig:synt}a. The exact
interval velocity profile is shown by a red curve.}

\inputdir{mig}

\plot{bvint}{width=\columnwidth}{Oriented mapping to interval velocity
for the field data set shown in Figure~\ref{fig:pnmo}a.}

\subsection{Migration to zero offset}

NMO correction accomplishes mapping to zero offset in the case of
horizontal reflectors. Taking account of the reflector dip effect
requires dip moveout \cite[]{dmo}. Combined with NMO, dip moveout maps
the input data in time-offset-midpoint coordinates $\{t,h,y\}$ to
time-midpoint coordinates $\{t_0,y_0\}$ at the zero-offset
section. The corresponding oriented mapping, derived in Appendix B, is
\begin{eqnarray}
  \label{eq:tzo}
  t_0^2 & = & t\,\frac{\left[(t- h\,p_h)^2 - h^2\,p_y^2\right]^2}
  {(t-h\,p_h)^3}\;, \\
  \label{eq:yzo}
  y_0 & = & y - \frac{h^2\,p_y}{t - h\,p_h}\;,
\end{eqnarray}
where $h = l/2$, and $p_h=\partial t/\partial h$ and $p_y=\partial
t/\partial y$ are prestack slopes.

\plot{bei}{width=\columnwidth}{A field 2-D dataset from the Gulf of
  Mexico used for numerical experiments. The display in this and
  other 3-D figures is composed of three sections from the cube
  indicated by vertical and horizontal lines.}

\multiplot{2}{hdip,ydip}{height=0.35\textheight}{ Prestack data slopes
  estimated from the dataset. a: Offset slope $p_h$. b: Midpoint slope
  $p_y$.}

The full 2-D dataset and the estimated prestack slopes are shown in
Figures~\ref{fig:bei} and \ref{fig:hdip,ydip}, respectively. The
output of migration to zero offset and stack is shown in
Figures~\ref{fig:bei-mzo} (before stack) and~\ref{fig:bei-mzo2} (after
stack). All major events are properly transformed to the appropriate
zero-offset positions.

\plot{bei-mzo}{width=\columnwidth}{Output of oriented migration to
zero offset.}

\plot{bei-mzo2}{width=\columnwidth}{Seismic stack obtained
  by oriented migration to zero offset.}

\subsection{Oriented prestack time migration}

Mapping prestack data to the reflector position expressed in vertical
traveltime is the task of prestack time migration. % The geometrical
%interpretation of time-migrated images is given by
%\cite{GPR25-04-07380745}. 
Analogously to dip moveout, prestack migration moves events not only
across offsets % to a zero offset image
but also across different midpoints provided that the reflectors are
not flat. Using the oriented approach, mapping from \new{the} prestack
domain $\{t,h,y\}$ to the time-migrated image domain $\{\tau,x\}$ is
\old{described} \new{defined} by the following equations derived in Appendix B:
\begin{eqnarray}
  \label{eq:pstmt}
  \tau^2 & = & 
  \frac{t\,p_h\,\left[(t-h\,p_h)^2 - h^2\,p_y^2\right]^2}
  {(t-h\,p_h)^2\,\left[t\,p_h + h\,(p_y^2-p_h^2)\right]}\;, \\
  \label{eq:pstmx}  
  x & = & y - \frac{h\,t\,p_y}{t\,p_h + h\,(p_y^2-p_h^2)}\;.
\end{eqnarray}
Here $\{\tau,x\}$ are the time-migrated image coordinates that
correspond to the vertical ray traveltime and location
\cite[]{GPR25-04-07380745}.

Under the assumption of a hyperbolic diffraction moveout, the migration velocity
becomes, analogously to equation~\ref{eq:vnmo}, a data attribute completely
defined by prestack slopes, as follows:
\begin{equation}
  {\frac{4}{v^2}} = {\frac{t\,\left[t\,p_h + h\,(p_y^2-p_h^2)\right]}
  {h\,(t-h\,p_h)}}\,.
  \label{eq:vmig}
\end{equation}
Equations~\ref{eq:pstmt} and \ref{eq:vmig} transform to
equations~\ref{eq:nmo2} and \ref{eq:vnmo} when $p_y=0$, which
corresponds to horizontal reflectors. \new{Equations analogous
to~\ref{eq:pstmt}, \ref{eq:pstmx}, and~\ref{eq:vmig} were derived
previously by \cite{GEO68-03-10081021} in a different way and in the
depth imaging context.}

Figures~\ref{fig:bei-mig} and~\ref{fig:bei-mig2} show the output of
prestack migration before and after stack. The result is comparable to
that of conventional processing \cite[]{bei} but obtained two orders
of magnitude faster, since each data point \old{is transformed}
\new{transforms} directly to the image space through a one-to-one
mapping instead of being spread along a wide migration impulse
response, as in \old{the} conventional prestack time migration.

\plot{bei-mig}{width=\columnwidth}{Output of oriented prestack time
  migration.}

\plot{bei-mig2}{width=\columnwidth}{Seismic image obtained by oriented
  prestack time migration.}

\section{Discussion}

The \old{apparent} \new{main} advantage of the oriented approach is
speed. The cost of velocity scanning in conventional processing
(excluding the manual picking labor involved) can be estimated roughly
as the number of scanned velocities $N_v$ times the input data
size. The cost increases dramatically in the case of non-hyperbolic
approximations when more than one parameter needs to be picked.  The
cost of local slope estimation with the plane-wave destruction method
is roughly the data size times the number of iterations $N_i$ times
the filter size $N_f$. Typically, $N_i \approx 10$ and $N_f = 6$,
which is approximately equivalent in cost to scanning $N_v=60$
velocities. The next step, however, is dramatically different. Since
each data point is mapped directly to the image instead of being
spread into a wide impulse response, we save the factor in cost
proportional to the size (in samples) of the migration impulse
response.  The prestack migration result shown in
Figure~\ref{fig:bei-mig} was accomplished in under 10 seconds on a
single-node PC.

The cost savings will be reduced somewhat if we take into account more
than one local slope (crossing reflection events, diffractions,
multiple reflections, etc.) The plane-wave destruction algorithm
\cite[]{GEO67-06-19461960} can be applied for estimating several
interfering data slopes simultaneously. In order to take full
advantage of it, data decomposition into local slope components may be
required. The curvelet transform \cite[]{SEG-2003-09971000,huub}
suggests a possible data decomposition approach. \new{To extend the
method of curvelet imaging developed by \cite{huub2},} each local
slope component would need to be imaged separately by an oriented
approach with its contribution stacked into the final image.

Seismic imaging and velocity estimation is inherently an uncertain
process \new{because of limitations in the data acquisition geometry
and signal bandwidth}. In the oriented approach, the uncertainty in
the velocity estimation and in the positioning of seismic reflectors
comes directly from the uncertainty in estimating local event
slopes. Such uncertainty \old{can be} \new{is} much easier to estimate
and analyze \new{in the oriented rather} than in the traditional
approach \new{thanks to} the explicit \old{oriented} time-domain
imaging equations \old{such as} \ref{eq:pstmt} and~\ref{eq:pstmx}
\old{can} \new{that} transform uncertainties in the local event slopes
$p_h$ and $p_y$ directly into uncertainties of the image point
positioning.

%, which is perhaps an even more significant
%advantage.
\section{Conclusions}

Local slopes of seismic events contain complete information about the
reflection geometry. Once they are estimated, one can turn seismic
velocities and all other moveout parameters into data attributes
directly mappable from the prestack data domain into the time-migrated
image domain. In this paper, I have developed the analytical theory
for this transformation and demonstrated its applicability with
examples.

Extensions of oriented imaging from time to depth migration are
provided in \old{the theory of} parsimonious migration
\cite[]{GEO68-03-10431051} using a ray tracing formalism and in the
theory of the oriented wave equation \cite[]{SEG-2003-08930898} using
a wave equation formalism.

\section{Acknowledgments}

I would like to thank Jon Claerbout and Antoine Guitton for inspiring
discussions. Huub Douma, \new{Gilles Lambar\'{e}, Isabelle Lecomte,
and one anonymous reviewer provided} thorough and helpful reviews.

This publication is authorized by the Director, Bureau of Economic
Geology, The University of Texas at Austin.

\append{Mathematical derivation of oriented Dix inversion}

The famous Dix inversion formula \cite[]{GEO20-01-00680086} can be
written in the form
\begin{equation}
  \label{eq:dix}
  v_i^2 = \frac{d}{d\,t_0}\,\left[t_0\,v^2(t_0)\right]\;,
\end{equation}
where $v_i$ is the interval velocity corresponding to the zero-offset
traveltime $t_0$ and $v(t_0)$ is the vertically-variable
root-mean-square velocity. By a straightforward application of the
chain rule, I rewrite the Dix equation in the form
\begin{equation}
  \label{eq:dix1}
  v_i^2 = \frac{d\,\left[t_0(t)\,v^2(t)\right]/d\,t}
  {d\,t_0/d\,t}.
\end{equation}
Substituting $t_0(t)$ and $v(t)$ dependences from
equations~\ref{eq:nmo2} and~\ref{eq:vnmo} and doing algebraic
simplifications \new{yields}
\begin{eqnarray}
  \label{eq:dvdt}
  \frac{d\,\left[t_0(t)\,v^2(t)\right]}{d\,t} & = & \frac{l}{p^2\,t}\,
  \frac{p\,l (p + t\,p_t) - 2 p_t\,t^2}{2\,t_0}\;, \\
  \label{eq:dt0dt}
  \frac{d\,t_0}{d\,t} & = & \frac{2\,t - l\,(p + t\,p_t)}{2\,t_0}\;,
\end{eqnarray}
where $p_t = \partial p/\partial t$.  \new{Substituting
  equations~\ref{eq:dvdt} and~\ref{eq:dt0dt} into~\ref{eq:dix1}}
produces equation~\ref{eq:vi} in the main text.

\append{Mathematical derivation of oriented time-domain imaging operators}

\inputdir{XFig}

\plot{rays}{width=\textwidth}{Reflection ray geometry in an
effectively homogeneous medium (a scheme).}

The mathematical derivation of oriented time-domain imaging operators
\old{is based on} \new{follows} geometrical principles. Consider the
reflection ray geometry in Figure~\ref{fig:rays}. Making a hyperbolic
approximation of diffraction traveltimes used in seismic time
migration is equivalent to assuming an effective constant-velocity
medium and straight-ray geometry. The geometrical connection between
the effective dip angle~$\alpha$, the effective reflection
angle~$\theta$, the effective velocity $v$, half-offset~$h$, and the
reflection traveltime~$t$ is given by the equation
\begin{equation}
\label{eq:trig}
t = \frac{2\,h}{v}\,\frac{\cos{\alpha}}{\sin{\theta}}\;,
\end{equation}
which follows directly from the trigonometry of the reflection
triangle \cite[]{Clayton.sep.14.21,GEO68-05-16501661}. Additionally,
the two angles are connected with the traveltime derivatives $p_h =
\partial t/\partial h$ and $p_y = \partial t/\partial y$ according to
equations 
\begin{eqnarray}
\label{eq:ph}
p_h & = & \frac{2\,\cos{\alpha}\,\sin{\theta}}{v}\;, \\
\label{eq:py}
p_y & = & \frac{2\,\sin{\alpha}\,\cos{\theta}}{v}\;.
\end{eqnarray}
Using equations~\ref{eq:trig}, \ref{eq:ph}, and~\ref{eq:py}, one
can explicitly solve for the effective parameters $\alpha$, $\theta$,
and $v$ expressing them in terms of the data coordinates $t$ and $h$ and
event slopes $p_h$ and $p_y$. The solution takes the form
\begin{eqnarray}
\label{eq:alpha}
\tan^2{\alpha} & = & \frac{h\,p_y^2}{p_h\,(t-h\,p_h)}\;, \\
\label{eq:theta}
\sin^2{\theta} & = & \frac{h\,p_h}{t}\;, \\
\label{eq:v}
v^2 & = & \frac{4\,h\,(t-h\,p_h)}{t\,\left[t\,p_h + h\,(p_y^2-p_h^2)\right]}\;.
\end{eqnarray}
Note that equation~\ref{eq:v} is equivalent to
equation~\ref{eq:vmig} in the main text. It reduces to
equation~\ref{eq:vnmo} in the case of a horizontal reflector ($p_y=0$).

With the help of equations~\ref{eq:alpha}, \ref{eq:theta},
and~\ref{eq:v}, one can transform all other geometrical quantities
associated with time-domain imaging into data attributes. The vertical
two-way time is \cite[]{GEO68-03-10651074}
\begin{equation}
\label{eq:tau}
\tau = t\,\frac{\cos^2{\alpha} -
\sin^2{\theta}}{\cos{\alpha}\,\cos{\theta}}\;,
\end{equation}
which turns, after substituting equations~\ref{eq:alpha}
and~\ref{eq:theta}, into equation~\ref{eq:pstmt} in the main
text. The separation between the midpoint and the vertical is
\cite[]{GEO68-03-10651074}
\begin{equation}
\label{eq:ymx}
y - x = h\,\frac{\sin{\alpha}\,\cos{\alpha}}{\sin{\theta}\,\cos{\theta}}\;,
\end{equation}
which turns, after substituting equations~\ref{eq:alpha}
and~\ref{eq:theta}, into equation~\ref{eq:pstmx} in the main text.
Additionally, the zero-offset traveltime is \new{(using equation~\ref{eq:tau})}
\begin{equation}
\label{eq:t0}
t_0 = \frac{\tau}{\cos{\alpha}} = t\,\frac{\cos^2{\alpha} -
\sin^2{\theta}}{\cos^2{\alpha}\,\cos{\theta}}\;,
\end{equation}
which turns into equation~\ref{eq:tzo}. Finally, the separation
between the midpoint and the zero-offset point is \new{(using
equations~\ref{eq:trig} and~\ref{eq:ymx})}
\begin{equation}
\label{eq:ymy0}
y - y_0 = y - x - \frac{v\,\tau}{2}\,\tan{\alpha} =
h\,\tan{\alpha}\,\tan{\theta}\;,
\end{equation}
which turns into equation~\ref{eq:yzo}. In the case of a horizontal
reflector ($\alpha=0$), $y=y_0=x$, $t_0 = \tau$, and the zero-offset
traveltime reduces to the NMO-corrected traveltime in
equation~\ref{eq:nmo2}.

Non-hyperbolic and three-dimensional generalizations of this theory are
possible.

\bibliographystyle{seg}
\bibliography{SEG,SEP2,pmig}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
