\published{SEG Expanded Abstracts, 25, 2460-2464, (2006)}
\title{Time-shift imaging condition for converted waves}
\author{
Paul Sava, Center for Wave Phenomena, Colorado School of Mines, Golden CO 80401, USA \\
Sergey Fomel, Bureau of Economic Geology, University of Texas (Austin), Austin, TX 78758, USA
}

\maketitle

\input{macro}

% ------------------------------------------------------------
\begin{abstract}
A typical imaging condition for seismic reflection data 
involves source and receiver wavefield matching, e.g. by
cross-correlation, at every image location. 
This statement is true no matter how the two wavefields
are reconstructed, for example by 
one-way wavefield extrapolation, or
two-way reverse-time extrapolation, or
Kirchhoff integral methods.
This statement is also true when the source and receiver
wavefields are reconstructed using different velocity models,
as is the case for imaging of converted waves.
Angle-dependent reflectivity information can be extracted
from the source and receiver wavefield by retaining multiple lags
of the imaging cross-correlation, i.e. by analyzing the match of 
wavefields shifted relative to one-another.
Wavefields can be shifted in space (3D) or in time (1D), and
each shift method has an associated angle-decomposition method.
This paper explores the various types of imaging condition 
using space- and time-shifts and
derives relations for angle decomposition for converted-wave
imaging.
\end{abstract}

% ------------------------------------------------------------
\section{Introduction}
A key challenge for imaging in complex areas is accurate
determination of a velocity model in the area under investigation.
Migration velocity analysis is based on the principle that
image accuracy indicators are optimized when
data are correctly imaged.
A common procedure for velocity analysis is to examine the
alignment of images created with multi-offset data.
An optimal choice of image analysis can be done in the
angle domain which is free of complicated
artifacts present in surface offset gathers in complex areas
\cite[]{GEO69-02-05620575}.
\par
Migration velocity analysis after migration by wavefield
extrapolation requires image decomposition
in scattering angles relative
to reflector normals. Several methods have
been proposed for such decompositions
\cite[]{GEO55-09-12231234,
SEG-1999-08240827,
SEG-2000-08300833,
GEO67-03-08830889,
XieWu.adcig,
GEO68-03-10651074,
SEG-2003-08890892,
Fomel.seg.3dadcig,
SEG-2003-21042107}.
These procedures require decomposition of
extrapolated wavefields in variables that are
related to the reflection angle.

A key component of such image decompositions
is the imaging condition.
A careful implementation of the imaging condition preserves
all information necessary to decompose images in their
angle-dependent components.
The challenge is efficient and reliable construction of these
angle-dependent images for velocity or amplitude analysis.

In migration with wavefield extrapolation, a prestack imaging condition
based on spatial shifts of the source and receiver wavefields allows
for angle-decomposition
\cite[]{GEO67-03-08830889,SavaFomel.segab2.2005}.
Such formed angle-gathers describe reflectivity as a
function of reflection angles and are powerful tools for migration
velocity analysis (MVA) or amplitude versus angle analysis (AVA).
However, due to the large expense of space-time
cross-correlations, especially in three dimensions,
this imaging methodology is not yet used routinely in data processing.

A different form of imaging condition involves
time-shifts instead of space-shifts
between wavefields computed from sources and receivers
\cite[]{SavaFomel.geo.tsic}.
Similarly to the space-shift imaging condition, an image is built by
space-time cross-correlations of subsurface wavefields,
and multiple lags of the time cross-correlation are preserved in the image.
Time-shifts have physical meaning that can be related directly
to reflection geometry, similarly to the procedure used for
space-shifts.
Furthermore, time-shift imaging is cheaper to apply than space-shift
imaging, and thus it might alleviate some of the difficulties
posed by costly cross-correlations in 3D space-shift imaging condition.

The time-shift imaging concept is applicable to Kirchhoff
migration, migration by wavefield extrapolation, or
reverse-time migration.
This concept is also applicable to migration of single-mode (PP) or 
converted-mode (PS) waves. In this paper, we develop the theory
and show examples of angle decomposition after time-shift 
imaging of converted waves. All formulas developed for this purpose
reduce to the previously-derived formulas for decomposition of 
single-mode images
\cite[]{SavaFomel.segab2.2005,SavaFomel.geo.tsic}.

% ------------------------------------------------------------
\section{Imaging condition}

If we make the assumption that seismic data consists
of singly-scattered reflections,
we can describe migration as a succession of two steps:
\par
{\bf Wavefield extrapolation}, in which step we construct
source and receiver wavefields from synthetic or recorded data.
The source and receiver wavefields are four-dimensional objects
denoted by the symbols $\us(\mm,t)$ and $\ur(\mm,t)$,
where $\mm$ indicates position in a three-dimensional space, and
$t$ indicates time.
In typical migration procedures,
the four-dimensional objects $\us$ and $\ur$ are not stored
explicitly, but they are computed on-the-fly as needed for imaging
at a given position $\mm$ in space.
\par
{\bf Imaging condition}, in which step we extract reflectivity
information by comparing the source and receiver wavefields.
A useful imaging condition produces a map of reflectivity at all locations
in space, function of angles of incidence and reflection. 
This information can be employed in migration velocity analysis (MVA) 
and amplitude-versus-angle analysis (AVA).

We can distinguish two parts of an imaging condition:
wavefield comparison and angle-decomposition.
In the first part, we explore the match of source and receiver 
wavefields and build objects containing reflectivity information.
Cross-correlation at every location in space is an example of 
wavefield comparison.
In the second part,
we extract the actual angle-dependent reflectivity information
from images produced by space-time wavefield cross-correlation. 

We can look at an imaging procedure formulated in this framework
as an exercise in matching of two four-dimensional objects.
Fundamentally, there is no difference between the four coordinate
axes, except for their physical meaning. We can exploit this similitude
of coordinate axes in formulating generic wavefield comparison procedures.
Deconvolution or cross-correlation are just two particular options.
Angle-decomposition, however, requires physical interpretation of the
four coordinate axes to extract meaningful information about reflection
angles. We exploit those physical relations to derive the formulas
presented in this paper.

All types of migration procedures for converted waves, including 
Kirchhoff migration, 
migration by wavefield extrapolation, 
reverse-time migration etc.
can be formulated in this framework.

\subsection{Conventional imaging condition}
A conventional imaging condition for shot-record
migration, also known as $U \K{D}$ imaging condition \cite[]{Claerbout.iei},
consists of time cross-correlation at every image location
between the source and receiver wavefields,
followed by image extraction at zero time.
Mathematically, we can represent this process by the relations
\bea
\uu  \left(\mm, t  \right) &=&
\us  \left(\mm, t  \right) \ast
\ur  \left(\mm, t  \right) \;,
\\
\RR  \left(\mm     \right) &=&
\uu  \left(\mm,t=0 \right) \;.
\eea
Here, $\mm=\mv$ is a vector
describing the locations of image points,
$\us(\mm,t)$ and
$\ur(\mm,t)$ are source and receiver wavefields
respectively, and $\RR(\mm)$ denotes the
migrated image, proportional to reflectivity at every location
in space.
The symbol $\ast$ denotes cross-correlation in time.

A typical implementation of this imaging condition is in the
Fourier domain, where the image is produced using the
expression
\beq
\RR   \left(\mm     \right) = \sum_\w
   \US\left(\mm,\w  \right)
\K{\UR\left(\mm,\w  \right)} \;,
\eeq
where summation over frequency $\w$ corresponds to imaging 
at zero time.
The over-line represents a complex conjugate
applied on the receiver wavefield $\UR$ in the
Fourier domain.

\subsection{Space- and time-shift imaging condition}
We can formulate a more general imaging condition 
based on cross-correlation of the source and receiver
wavefields after shifting in both time and space.
Mathematically, we can represent this process by the relations
\bea \label{eqn:imgD}
\uu  \left(\mm,\hh,t,\tt \right) &=&
\us  \left(\mm-\hh,t-\tt \right) \ast
\ur  \left(\mm+\hh,t+\tt \right) \;,
\\
\RR  \left(\mm,\hh,\tt     \right) &=&
\uu  \left(\mm,\hh,\tt,t=0 \right) \;.
\eea
Here, $\hh=\hv$ is a vector describing the local
source-receiver separation in the image space, and
 $\tt$ is a time-shift between the source
and receiver wavefields prior to imaging.
In this imaging condition we do not assume that the 
source and receiver wavefields maximize image strength
at the zero-lag of the space-time cross-correlation.
Instead, we probe wavefield similitude at other lags using
both shifting in space and time. 

This imaging condition can be implemented in the
Fourier domain using the expression
\beq \label{eqn:imgDw}
\RR   \left(\mm,\hh,\tt \right) = \sum_\w
   \US\left(\mm-\hh,\w  \right)
\K{\UR\left(\mm-\hh,\w  \right)} e^{2i\w\tt} \;.
\eeq
Special cases of this imaging condition correspond to
purely space-shift $\tt=0$, when the imaging condition reduces to
\cite[]{SavaFomel.segab2.2005}
\beq \label{eqn:imgHw}
\RR   \left(\mm,\hh      \right) = \sum_\w
   \US\left(\mm-\hh ,\w  \right)
\K{\UR\left(\mm+\hh ,\w  \right)} \;,
\eeq
or purely time-shift $\hh=0$, when the imaging condition reduces to
\cite[]{SavaFomel.geo.tsic}
\beq \label{eqn:imgTw}
\RR   \left(\mm,\tt \right) = \sum_\w
   \US\left(\mm,\w  \right)
\K{\UR\left(\mm,\w  \right)} e^{2i\w\tt} \;.
\eeq
The imaging procedures described in this section produce
images that can be used for angle decomposition
of reflectivity at every image location, thus making this 
imaging procedure useful for MVA or AVA.

The imaging conditions presented in this section make no assumption
on the nature of the source and receiver wavefields
We can reconstruct those two wavefields using any type of
extrapolation, or using different velocity models for extrapolation of
the source and receiver wavefields.

In the following section, we discuss angle-decomposition based on the
images obtained by conditions described in the current section.
For angle decomposition, we cannot ignore anymore the physical nature
of the two wavefields we are comparing, and we need to specify
what type of wave (P or S) do the various wavefields correspond to.
For the following analysis, we will assume that source wavefields
correspond to incident P waves, and receiver wavefields correspond to
reflected S waves.

% ------------------------------------------------------------
\inputdir{XFig}
\multiplot[t]{2}{experimentC,vecC}{height=1in}
{ (a) Synthetic PS reflection experiment, and
  (b) Geometric relations between ray vectors at an image point.}

% ------------------------------------------------------------
\section{Angle decomposition}
We can develop procedures for angle-decomposition starting
from the multi-lag cross-correlations constructed in the preceding
section. At this stage, we need to exploit the physical
meaning of the various lags, either along space axes or along
the time axis. In general, 3-D angle-decomposition should define 
reflectivity function of reflection and azimuth angles.
In this paper, we concentrate on decomposition function 
of the reflection angle only.

Using the definitions introduced in the preceding section,
we can make the standard notations for source and
receiver coordinates, respectively:
$\ss = \mm - \hh$ and $\rr = \mm + \hh$.
The traveltime from a source to a receiver is a function
of all spatial coordinates of the seismic experiment
$ t = t \lp \mm,\hh \rp$.
Suppose we could identify the function $t\lp \mm,\hh \rp$, then
differentiating $t$ with respect to all
components of the vectors $\mm$ and $\hh$,
and using the standard notations
$ {\bf p}_\alpha = \nabla_\alpha t$,
where $\alpha=\{\mm,\hh,\ss,\rr\}$, we can write
$\pmv = \prv + \psv$ and $\phv = \prv - \psv$.
Therefore, we can also write equivalent relations
$2\psv = \pmv - \phv$ and $2\prv = \pmv + \phv$.

By analyzing the geometric relations of various
vectors at an image point, Figure~\ref{fig:vecC},
we can write the trigonometric expressions:
\bea \label{eqn:PmPh-a}
4 \mph^2 &=& \mps^2 + \mpr^2 - 2 \mps \mpr \cos(2 \t) \;,
\\   \label{eqn:PmPh-b}
4 \mpm^2 &=& \mps^2 + \mpr^2 + 2 \mps \mpr \cos(2 \t) \;.
\eea 

\subsection{Space-shift angle decomposition for converted waves}
We can transform the expressions \req{PmPh-a}-\req{PmPh-b}
using the notations
$\mps=s$ and $\mpr=\g s$, where
$\g(\mm)$ is the $v_p/v_s$ ratio, and
$ s(\mm)$ is the slowness associated with the
incoming ray at every image point:
\bea \label{eqn:PmPh-a-cw}
\mph^2 &=& s^2 \lp 1+\g^2 -2\g \cos 2\t \rp \;,
\\   \label{eqn:PmPh-b-cw}
\mpm^2 &=& s^2 \lp 1+\g^2 +2\g \cos 2\t \rp \;.
\eea
If we eliminate $\w$ and make the notations 
$\mkh=\mph/\w$ and
$\mkm=\mpm/\w$, we obtain the expression
\cite[]{SavaFomel.segab1.2005}
\beq \label{eqn:C-h}
\tan^2 \t = \frac
{(1+\g)^2 \mkh^2 - (1-\g)^2 \mkm^2}
{(1+\g)^2 \mkm^2 - (1-\g)^2 \mkh^2} \;,
\eeq
that can be used for angle decomposition for
converted waves after space-shift imaging condition.
For PP reflections ($\g=1$), this expression reduces to
\beq
\tan^2 \t = \frac{\mkh^2}{\mkm^2} \;.
\eeq

\subsection{Time-shift angle decomposition for converted waves}
Using the same definitions for $\mps$ and $\mpr$ as in the 
preceding subsection, we can use equation~\req{PmPh-b-cw} 
to derive the relation
\beq \label{eqn:C-t-m}
\cos^2 \t = \frac{1}{\g} \frac{\mpm^2}{4s^2} - \frac{\lp 1-\g \rp^2}{4\g} \;.
\eeq
For PP reflections ($\g=1$), this expression reduces to
\beq
\cos \t = \frac{\mpm}{2s} \;.
\eeq

% ------------------------------------------------------------
\section{Algorithms}
In the most general case described in this paper, a seismic image 
is a multi-dimensional object function of position $\mm$,
space-shift $\hh$ and time-shift $\tt$, $\RR(\mm,\hh,\tt)$.
We can use the relations between space and time coordinates
developed in the preceding section to define various 
angle-decomposition algorithms. 
Since $\RR(\mm,\hh,\tt)$ is a large object that is unlikely, in practice,
to be computed or stored completely, we design algorithms involving
subsets of this large image:

\subsection{Space-shift angle decomposition}
If we construct a seismic image using only space-shift $\RR(\mm,\hh)$,
we use equation~\req{C-h} for angle decomposition of converted-mode waves.
The computation and storage requirements are high, since
we need to store images for 3-D cross-correlation lags.
However, if only the reflection angle is of interest, we can 
reduce cost by storing only the absolute value of the space-shift
vector \cite[]{SavaFomel.segab2.2005}.

A decomposition algorithm is a follows:
\[
\RR(\mm,\hh) \rightarrow
\RR(\kmv,\khv) \rightarrow
\RR(\kmv,\mkh/\mkm) \rightarrow
\RR(\mm,\theta)
\]
where each arrow indicates a transformation from one domain
to another, and $\kmv$ and $\khv$ are the Fourier duals of
position $\mm$ and space-shift $\hh$.
The transform from $(\mm,\hh)$ to $(\kmv,\khv)$ and back
represent Fourier transforms, and the transformation
from $(\kmv,\khv)$ to $(\kmv,\mkh/\mkm)$ represents slant-stacking.
The decomposition
from the slant-stack parameter $\mkh/\mkm$ to the
reflection angle $\theta$ requires a 
space-domain correction based on the $v_p/v_s$ ratio $\gamma$.

\subsection{Time-shift angle decomposition}
If we construct a seismic image using only time-shift $\RR(\mm,\tt)$,
we use equation~\req{C-t-m} for angle decomposition
of converted-mode waves.
The computation and storage requirements are small, since
we need to store images for 1-D cross-correlation lags.
However, although the cost is smaller, we lose the option of computing
the azimuth of the reflection and we are limited only to the 
reflection angle.

A decomposition algorithm is a follows:
\[
\RR(\mm,\tt) \rightarrow
\RR(\kmv,\w) \rightarrow
\RR(\kmv,\mkm/\w) \rightarrow
\RR(\mm,\theta)
\]
where $\kmv$ and $\w$ are the Fourier duals of 
position $\mm$ and time-shift $\tt$.
The decomposition
from the slant-stack parameter $\mkm/\w$ requires a 
space-domain correction based on the 
slowness $s$ and the $v_p/v_s$ ratio $\gamma$.

% ------------------------------------------------------------
\section{Example}

We illustrate the imaging and angle-decomposition methods derived
in this paper with a synthetic example.
The reflectivity model consists of five reflectors of increasing
slopes, from $0^\circ$ to $60^\circ$, as illustrated in 
Figure~\ref{fig:experimentC}.
In this experiment, 
the P-wave velocity is $v_p=3200$~m/s and 
the S-wave velocity is $v_s=800$~m/s. 
We chose those velocities in order to capture reflections off the 
steeper dipping reflectors in a reasonable acquisition geometry.
In this experiment, we analyze one common-image gather located
at the same horizontal position as the surface seismic source.
In this way, the reflector dip is equal to the angle of incidence
on each reflector.

Figure~\ref{fig:experimentC} shows a schematic of a converted-mode (PS)
experiment. Given the constant velocity of the model, 
the single-mode data from the reflector dipping more than $45^\circ$ 
would not be recorded at the surface.
In contrast, the converted-mode data from all reflectors
are recorded at the surface.

\inputdir{cwtsic3}
% ------------------------------------------------------------
\plot[t]{ps}{width=3.0in}{Synthetic PS reflection data}
% ------------------------------------------------------------
\plot[b]{psimg-h}{width=3.0in}{Migrated image for PS data}
% ------------------------------------------------------------

Figure~\ref{fig:ps} shows the converted-mode seismic data from all
five reflectors. We analyze the positive offsets of the seismic data
which contain the reflections from the interfaces in the model.

We migrate this shot using one-way wavefield extrapolation using 
space-shift and time-shift imaging conditions.
Figure~\ref{fig:psimg-h} shows the migrated image at
zero shift.
As predicted by theory, this image is identical 
for both space-shift and time-shift imaging conditions when the 
values of the shift is zero.

Figures~\ref{fig:psoff-h}-\ref{fig:psang-h}
show different views of the common-image gather (CIG) located at the 
same horizontal location as the source $x=1000$~m.
Panel (a) depicts the CIG resulting from the space-shift imaging
condition. The vertical axis represents depth $z$ and the horizontal
axis represents horizontal space-shift labeled, for simplicity, $h$.
Panel (b) depicts the same CIG after slant-stack in the $z-h$ space.
The horizontal axis is the slant-stack parameter, which is related to
the reflection angle at every reflector, except for a correction based
on dip and the $v_p/v_s$ ratio.
Panel (c) depicts the same CIG after transformation to reflection 
angle $\t$ using local values of P and S velocities, as well as a 
correction for the structural dip measured on the migrated image
depicted in Figure~\ref{fig:psimg-h}.
As expected, each reflector is represented in this final plot at
a specific angle of incidence. The vertical lines indicate the 
correct reflection angles of converted waves reflecting from the 
interfaces dipping at angles between $0^\circ$ and $60^\circ$.

Figures~\ref{fig:psoff-t}-\ref{fig:psang-t} show a similar analysis
to the one in Figures~\ref{fig:psoff-h}-\ref{fig:psang-h} but for
imaging using time-shift.
Panel (a) depicts one CIG at $x=1000$~m,
panel (b) depicts the CIG after slant-stack in the $z-\tt$ space, and
panel (c) depicts the CIG after transformation to reflection angle,
including the space-domain corrections for structural dip and 
$v_p/v_s$ ratio.

As for the space-shift images, the energy corresponding to every reflector
from the CIG obtained by time-shift imaging concentrates well in the 
slant-stack panels, Figures\ref{fig:psssk-h} and \ref{fig:psssk-t}.
However, a striking difference occurs in the $z-\t$ panels:
while the energy for every reflector 
in Figure~\ref{fig:psang-h} concentrates well,
the energy in Figure~\ref{fig:psang-t} is much less focused, 
particularly at small angles.

This phenomenon was observed and discussed in detail by 
\cite{SavaFomel.segab2.2005}, and it is related to the lower angular resolution 
for time-shift imaging at small angles. This fact is illustrated
in Figures~\ref{fig:ssk}-\ref{fig:cor} depicting impulse response
transformations for time-shift imaging:
panel (a) depicts various events in a slant-stack panel,
similar to Figure~\ref{fig:psssk-t}, and
panel (b) depicts the same events in a reflection angle panel,
similar to Figure~\ref{fig:psang-t}.
At small reflection angles, the angular resolution is low, but it increases
at large reflection angles to levels comparable with those of 
reflections mapped using space-shift imaging.
The simple explanation for this phenomenon is that 
the space-shift transformation involves the $\tan \t$ trigonometric
function whose slope at $\t \rightarrow 0$ is equal to $1$,
while the time-shift transformation involves the $\cos \t$ function
whose slope at $\t \rightarrow 0$ is equal to $0$.
Thus, even given equivalent slant-stack resolutions,
the angle resolution around $\t=0$ is poorer for time-shift
imaging than for space-shift imaging because of the
different trigonometric function.

% ------------------------------------------------------------
\multiplot{3}{psoff-h,psssk-h,psang-h}{width=0.90in}
{Common-image gather at $x=1000$~m for space-shift imaging condition:
common-image gather (a),
slant-stack gather (b) and
common-angle gather (c).}
% ------------------------------------------------------------
% ------------------------------------------------------------
\multiplot{3}{psoff-t,psssk-t,psang-t}{width=0.90in}
{Common-image gather at $x=1000$~m for time-shift imaging condition:
common-image gather (a),
slant-stack gather (b) and
common-angle gather (c).}
% ------------------------------------------------------------
% ------------------------------------------------------------
\multiplot{2}{ssk,cor}{width=0.90in}
{Resolution experiment for time-shift imaging condition:
simulated slant-stack (a) and
angle-decomposition (b).
Although the slant-stack is well focused for all events 
both function of  depth $z$ and slant-stack parameter $\nu$, 
the resolution of the angle transformation is lower at small 
angles and higher at large angles.
}
% ------------------------------------------------------------

% ------------------------------------------------------------
\section{Conclusions}
We develop imaging conditions for converted waves
based on time-shifts between source and receiver wavefields.
This method is applicable to Kirchhoff, reverse-time and
wave-equation migrations and produces common-image gathers
indicative of velocity errors.
In wave-equation migration, time-shift imaging is
more efficient than space-shift imaging, since it only involves
a simple phase shift prior to the application
of the usual imaging cross-correlation.
Disk storage is also reduced, since the output volume
depends on only one parameter (time-shift $\tt$) instead
of three parameters (space-shift $\hh$).
We show how this imaging condition can be used to
construct angle-gathers from time-shift gathers.
Although time-shift imaging is, in principle, capable of 
representing the same information as space-shift imaging,
in practice the angular resolution of the angle decomposition for
time-shift is much lower than the one for space-shift.
This inconvenience needs to be addressed by future research.

% ------------------------------------------------------------
\section{Acknowledgment}
We would like to acknowledge ExxonMobil for partial financial support
of this research.

% ------------------------------------------------------------
\bibliographystyle{seg}
\bibliography{SEG,PCS,MISC}

