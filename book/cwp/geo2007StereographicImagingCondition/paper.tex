\published{Geophysics, 72 , no. 6, A87-A91, (2007)}
\title{Stereographic imaging condition for wave-equation migration}
\author{Paul Sava (Colorado School of Mines)}
\email{psava@mines.edu}

\input{pcsmacros}
\input{macro}

\righthead{Stereographic imaging}
\lefthead{Sava}
%\ms{GEO-2007-0111}

\maketitle
% ------------------------------------------------------------
\begin{abstract}
Imaging under the single-scattering approximation consists of two
steps: wavefield reconstruction of source and receiver wavefields from
simulated and recorded data, respectively, and imaging from the
extrapolated wavefields of the locations where reflectors occur.
Conventionally, the imaging condition indicates the presence of
reflectors when propagation times of reflections in the source and
receiver wavefields match. The main drawback of conventional
cross-correlation imaging condition is that it ignores the local
spatial coherence of reflection events and relies only on their
propagation time. This leads to interference between unrelated events
that occur at the same time. Sources of cross-talk include seismic
events corresponding to different seismic experiments, or different
propagation paths, or different types of reflections (primary or
multiple) or different wave modes (P or S). An alternative imaging
condition operates on the same extrapolated wavefields, but
cross-correlation takes place in a higher-dimensional domain where
seismic events are separated based on their local space-time
slope. Events are matched based on two parameters (time and local
slope), thus justifying the name ``stereographic'' for this imaging
condition. Stereographic imaging attenuates wavefield cross-talk and
reduces imaging artifacts compared with conventional imaging.
Applications of the stereographic imaging condition include
simultaneous imaging of multiple seismic experiments, multiple
attenuation in the imaging condition, and attenuation of cross-talk
between multiple wavefield branches or between multiple wave modes.
\end{abstract}

% ------------------------------------------------------------
\section{Introduction}
Conventional depth migration consists of two steps: wavefield
reconstruction of seismic wavefields at all locations in the imaging
volume from data recorded on the acquisition surface, and
imaging used to extract reflectivity information from
wavefields reconstructed from the sources and receivers. Accurate
imaging requires accurate implementation of both steps.  Recent
seismic imaging research places larger emphasis on wavefield
extrapolation than on imaging, partly due to the larger computational
cost of extrapolation relative to imaging.

This paper concentrates on the imaging condition assuming that
wavefield extrapolation is performed in a sufficiently accurate
velocity model. The imaging condition is often implemented as a
cross-correlation of source and receiver wavefields extrapolated from
the acquisition surface \cite[]{Claerbout.iei}. The reason for this
choice is that conventional cross-correlation imaging is fast and
robust, producing good images in complex environments. The alternative
deconvolution imaging condition is not discussed in this paper.

Conventional imaging condition operates in a simple way: source and
receiver wavefields are probed to determine the locations where they
match, i.e. where the traveltime of events forward-propagated from the
source and backward-propagated from the receivers are equal. This is
usually achieved by extracting the zero-lag of the temporal
cross-correlation between the two wavefields computed at every
location in the image. However, this imaging condition ignores the
structure of the analyzed seismic wavefields, i.e. the imaging
condition does not use the local space-time coherence of the reflected
wavefields. This characteristic is contrary to conventional analysis
of space-time kinematic coherence of seismic data, which is one of the
most important attributes employed in their analysis.

The consequence of this deficiency is that different seismic events
present in the extrapolated wavefields interfere with one-another
leading to artifacts in seismic images. This interference, also known
as cross-talk, occurs between unrelated events which should
not contribute to the formed image. It is often possible to identify
events that occur at the same time, although they describe different
propagation paths in the subsurface. As a consequence, such unrelated
events appear as real reflections due to the imaging condition and not
due to a geological cause.

This paper presents an extension of the conventional imaging
condition.  This extension is designed to exploit the local space-time
coherence of extrapolated wavefields. Different seismic events are
matched both function of propagation time and a local coherence
attributes, e.g. local slope measured function of position and time.
Therefore, events with different propagation paths are differentiated
from one-another, although their propagating time to a given point in
the subsurface may be identical
\cite[]{GEO69-02-05620575}. This property can be used to suppress
artifacts due to cross-talk and generate cleaner seismic images.

% ------------------------------------------------------------
\section{Conventional imaging condition}
Under the single scattering (Born) approximation, seismic migration
consists of two components: wavefield reconstruction and imaging.

Wavefield reconstruction forms solutions to the considered (acoustic)
wave-equation with recorded data as boundary condition. We can
consider many different numeric solutions to the acoustic
wave-equation, which are distinguished, for example, by implementation
domain (space-time, frequency-wavenumber, etc.)  or type of numeric
solution (differential, integral, etc.). Irrespective of numeric
implementation, we reconstruct two wavefields, one forward-propagated
from the source and one backward-propagated from the receiver
locations. Those wavefields can be represented as four-dimensional
objects function of position in space $\mm=\lp x,y,z\rp$ and time $t$
\bea 
\label{eqn:US} \US &=& \US \lp \mm,t \rp \\
\label{eqn:UR} \UR &=& \UR \lp \mm,t \rp \;,
\eea
where $\US$ and $\UR$ denote source and receiver wavefields. For the
remainder of this paper, we can assume that the two wavefields have
been reconstructed with one of the numerical methods mentioned
earlier.

The second migration component is the imaging condition which is
designed to extract from the extrapolated wavefields ($\US$ and $\UR$)
the locations where reflectors occur in the subsurface. The image
$\RR$ can be extracted from the extrapolated wavefields by evaluating
the match between the source and receiver wavefields at every location
in the subsurface. The wavefield match can be evaluated using an
extended imaging condition
\cite[]{SavaFomel.segab2.2005,SavaFomel.geo.tsic}, where image $\RR$ 
represents an estimate of the similarity between the source and
receiver wavefields in all $4$ dimensions, space ($\xx$) and time
($t$):
\beq \label{eqn:EIC}
   \RR  \lp \mm,\hh,   \tt \rp =
\tint{
   \US  \lp \mm-\hh, t-\tt \rp 
   \UR  \lp \mm+\hh, t+\tt \rp } \;.
\eeq
The quantities $\hh$ and $\tt$ represent the spatial and temporal
cross-correlation lags between the source and receiver wavefields.
The source and receiver wavefields are coincident (i.e. form an image)
if the local cross-correlation between the source and receiver
wavefields maximizes at zero-lag on all four dimensions. Other
extended imaging conditions
\cite[]{RickettSava.geo.img,BiondiSymes.adcig} represent special cases
of the extended imaging condition corresponding to horizontal $\hh=\lp
\lambda_x,\lambda_y,0\rp$, or vertical $\hh=\lp 0,0,\lambda_z\rp$
space lags, respectively. The conventional imaging condition
\cite{Claerbout.iei} is also a special case of the extended imaging
condition \ren{EIC}, corresponding to zero cross-correlation lag in
space ($\hh=0$) and time ($\tt=0$):
\beq \label{eqn:CIC}
       \RR \lp \mm   \rp = 
\tint{ \US \lp \mm,t \rp 
       \UR \lp \mm,t \rp } \;.
\eeq

% ------------------------------------------------------------
\inputdir{flat4}
\multiplot[t]{3}{velo,refl,dd}{width=0.75\textwidth,angle=00}{
Constant velocity model (a), reflectivity model (b), data (c) and shot
locations at $x=600,1000,1200$~m).}
% ------------------------------------------------------------

% ------------------------------------------------------------
\inputdir{gaus1}
\multiplot[t]{3}{velo,refl,dd}{width=0.75\textwidth,angle=00}{
Velocity model with a negative Gaussian anomaly (a), reflectivity
model (b), data (c) and shot location at $x=1000$~m).}
% ------------------------------------------------------------

The four-dimensional cross-correlation \ren{EIC} maximizes at zero lag
if the source and receiver wavefields are correctly reconstructed. If
this is not true, either because we are using an approximate
extrapolation operator (e.g. one-way extrapolator with limited angular
accuracy), or because the velocity used for extrapolation is
inaccurate, the four-dimensional cross-correlation does not maximize
at zero lag and part of the cross-correlation energy is smeared over
space and time lags ($\hh$ and $\tt$). Therefore, extended imaging
conditions can be used to evaluate imaging accuracy, for example by
decomposition of reflectivity function of scattering angle at every
image location
\cite[]{SavaFomel.geo.ang,BiondiSymes.adcig,SavaFomel.geo.tsic}.
Angle-domain images carry information useful for migration velocity
analysis
\cite[]{BiondiSava.segab.1999,SavaBiondi.gp.wemva1,SavaBiondi.gp.wemva2,Shen:2005},
or for amplitude analysis
\cite[]{Sava.segab.2001}, or for attenuation of multiples
\cite[]{SavaGuitton.geo.mat,Artman.multiples}

The conventional imaging condition \ren{CIC} is the focus of this
paper. As discussed above, assuming accurate extrapolation, this
imaging condition should produce accurate images at zero
cross-correlation lags. However, this conclusion does not always hold
true, as illustrated next.

\rFgs{flat4-velo} and \rfn{flat4-refl} represent a simple model of 
constant velocity with a horizontal reflector. Data in this model are
simulated from $3$ sources triggered simultaneously at coordinates
$x=600,1000,1200$~m. Using the standard imaging procedure outlined in
the preceding paragraphs, we can reconstruct the source and receiver
wavefields, $\US$ and $\UR$, and apply the conventional imaging
condition \req{CIC} to obtain the image in \rFg{flat4-ii}. The image
shows the horizontal reflector superposed with linear artifacts of
comparable strength.

\rFgs{gaus1-velo} and \rfn{gaus1-refl} represent another simple model 
of spatially variable velocity with a horizontal reflector. Data in
this model are simulated from a source located at coordinate
$x=1000$~m. The negative Gaussian velocity anomaly present in the
velocity model creates triplications of the source and receiver
wavefields. Using the same standard imaging procedure outlined in the
preceding paragraphs, we obtain the image in \rFg{gaus1-ii}. The image
also shows the horizontal reflector superposed with complex artifacts
of comparable strength.

In both cases discussed above, the velocity model is perfectly known
and the acoustic wave equation is solved with the same
finite-difference operator implemented in the space-time domain.
Therefore, the artifacts are caused only by properties of the
conventional imaging condition used to produce the migrated image and
not by inaccuracies of wavefield extrapolation or of the velocity
model.

The cause of artifacts is cross-talk between events present in the
source and receiver wavefields, which are not supposed to match. For
example, cross-talk can occur between wavefields corresponding to
multiple sources, as illustrated in the example shown in
\rFgs{flat4-velo}-\rfn{flat4-refl}, multiple branches of a wavefield
corresponding to one source, as illustrate in the example shown in
\rFgs{gaus1-velo}-\rfn{gaus1-refl}, events that correspond to multiple
reflections in the subsurface, or multiple wave modes of an elastic
wavefield, for example between PP and PS reflections, etc.

% ------------------------------------------------------------
\inputdir{flat4}
\multiplot[t]{2}{ii,kk}{width=0.75\textwidth,angle=00}{
Images obtained for the model in \rFgs{flat4-velo}-\rfn{flat4-dd}
using the conventional imaging condition (a) and the stereographic
imaging condition (b).}
% ------------------------------------------------------------

\section{Stereographic Imaging Condition}
One possibility to remove the artifacts caused by the cross-talk
between inconsistent reflection events is to modify the imaging
condition to use more than one attribute for matching the source and
receiver wavefields. For example, we could use the time and slope to
match events in the wavefield, thus distinguishing between unrelated
events that occur at the same time (\rFg{stereo2}).

\inputdir{XFig}
% ------------------------------------------------------------
\plot{stereo2}{width=\textwidth}{Comparison of 
conventional imaging (a) and stereographic imaging (b).}
% ------------------------------------------------------------

A simple way of decomposing the source and receiver wavefields
function of local slope at every position and time is by local
slant-stacks at coordinates $\mm$ and $t$ in the four-dimensional
source and receiver wavefields. Thus, we can write the total source
and receiver wavefields ($\US$ and $\UR$) as a sum of decomposed
wavefields ($\WS$ and $\WR$):
\bea
\label{eqn:WS} \US \lp \mm,t \rp &=& \pint{\WS \lp \mm,\pp,t \rp} \\
\label{eqn:WR} \UR \lp \mm,t \rp &=& \pint{\WR \lp \mm,\pp,t \rp} \;.
\eea 
Here, the three-dimensional vector $\pp$ represents the local
slope function of position and time. Using the wavefields decomposed
function of local slope, $\WS$ and $\WR$, we can design a
stereographic imaging condition which cross-correlates the wavefields
in the decomposed domain, followed by summation over the decomposition
variable:
\beq \label{eqn:SIC}
       \RR \lp \mm       \rp = 
\sint{ \WS \lp \mm,\pp,t \rp 
       \WR \lp \mm,\pp,t \rp } \;.
\eeq
Correspondence between the slopes p of the decomposed source and
receiver wavefields occurs only in planes dipping with the slope of
the imaged reflector at every location in space. Therefore, an
approximate measure of the expected reflector slope is required for
correct comparison of corresponding reflection data in the decomposed
wavefields. The choice of the word ``stereographic'' for this imaging
condition is analogous to that made for the velocity estimation method
called stereotomography \cite[]{EAE-1997-P095,GEO68-03-10081021} which
employs two parameters (time and slope) to constrain traveltime
seismic tomography.

For comparison with the stereographic imaging condition \ren{SIC}, the
conventional imaging condition can be reformulated using the wavefield
notation \ren{WS}-\ren{WR} as follows:
\beq \label{eqn:CICs}
                 \RR \lp \mm       \rp = 
\tint{ \lb \pint{\WS \lp \mm,\pp,t \rp} \rb 
       \lb \pint{\WR \lp \mm,\pp,t \rp} \rb } \;.
\eeq
%
The main difference between imaging conditions \ren{SIC} and
\ren{CICs} is that in one case we are comparing independent slope
components of the wavefields separated from one-another, while in the
other case we are comparing a superposition of them, thus not
distinguishing between waves propagating in different directions.
This situation is analogous to that of reflectivity analysis function
of scattering angle at image locations, in contrast with reflectivity
analysis function of acquisition offset at the surface. In the first
case, waves propagating in different directions are separated from
one-another, while in the second case all waves are superposed in the
data, thus leading to imaging artifacts \cite[]{GEO69-02-05620575}.

\rFg{flat4-kk} shows the image produced by stereographic imaging of
the data generated for the model depicted in
\rFgs{flat4-velo}-\rfn{flat4-refl}, and \rFg{gaus1-kk} shows the
similar image for the model depicted in
\rFgs{gaus1-velo}-\rfn{gaus1-refl}.  Images \rfn{flat4-kk} and
\rfn{gaus1-kk} use the same source receiver wavefields as images
\rfn{flat4-ii} and \rfn{gaus1-ii}, respectively.  In both cases, the
cross-talk artifacts have been eliminated by the stereographic imaging
condition.

% ------------------------------------------------------------
\inputdir{gaus1}
\multiplot[t]{2}{ii,kk}{width=0.75\textwidth,angle=00}{
Images obtained for the model in \rFgs{gaus1-velo}-\rfn{gaus1-dd}
using the conventional imaging condition (a) and the stereographic
imaging condition (b).}
% ------------------------------------------------------------

% ------------------------------------------------------------
\inputdir{sigsbee2}
\multiplot{8}{ttr1,ii1,ttr2,ii2,ttr0,ii0,vel,kk}{width=0.4\textwidth,angle=00}
{ Data corresponding to shots located at coordinates $x=16$~kft (a),
$x=24$~kft (c), and the sum of data corresponding to both shot
locations (e).  Image obtained by conventional imaging condition for
the shots located at coordinates $x=16$~kft (b), $x=24$~kft (d) and
the sum of data for both shots (f). Velocity model extracted from the
Sigsbee 2A model (g) and image from the sum of the shots located at
$x=16$~kft and $x=24$~kft obtained using the stereographic imaging
condition (h).}

% ------------------------------------------------------------
\section{Example}
The stereographic imaging condition is illustrated with an example
derived from the Sigsbee 2A dataset \cite[]{SEG-2002-21222125}. Using
the model in \rFg{sigsbee2-vel}, two shots are simulated by wavefield
extrapolation modeling, \rFgs{sigsbee2-ttr1}-\rfn{sigsbee2-ttr2}, and
a third shot is synthesized by summing the two shots together,
\rFg{sigsbee2-ttr0}. Migration with conventional imaging condition of
the three shots produces the images in
\rFgs{sigsbee2-ii1}-\rfn{sigsbee2-ii0}. The two shots independently
illuminate different parts of the model,
\rFgs{sigsbee2-ii1}-\rfn{sigsbee2-ii2}, while the third composite shot
illuminates both sides of the image, \rFg{sigsbee2-ii0}. The image
produced by the composite shot is populated with artifacts due to the
cross-talk between the wavefields originating at the two shot
locations.

\rFg{sigsbee2-kk} shows the image obtained by imaging the
composite shot, \rFg{sigsbee2-ttr0}, using the stereographic imaging
condition. The image is free of artifacts and shows reflectors
extending over the entire image, as would be expected for illumination
from two shots at different locations. In this case, the stereographic
imaging condition needs to take into account the local dip of the
image. Since we cannot know the reflector dip prior to the
application of the imaging condition, we need to loop over a range of
possible dip angles and decompose the wavefields locally for all
possible slope combinations.
Thus, the stereographic imaging procedure matches the dip of wavefield
components in local windows around every image point. Assuming that
the local geologic dip is known, at least approximately, we could
consider looping over a small range of local dips, thus decreasing the
cost of the imaging condition. This approach was not used for the
examples shown in this paper and remains to be investigated by future
research.

% ------------------------------------------------------------
\section{Discussion}

The imaging procedure described in this paper requires additional
steps that add to the computational cost of imaging. Furthermore,
there are more parameters that need to be chosen. For example, if we
use local slant-stacks for local decomposition, we need to decide how
many local slopes we should use, how finely we need to sample the
slope parameters, how finely in space should we apply slant-stacking
of the source/receiver wavefields, etc. The number of local slopes
used for the imaging condition depends on wavefield sampling in space
and time in order to avoid aliasing. Those challenges remain to be
addressed by future research.

In all examples described in this paper, the local windows have simple
rectangular shape. However, more sophisticated window types
(e.g. Gaussian) are possible alternatives and might improve the
quality and efficiency of the method.

We can consider tuning the stereographic imaging condition for
specific applications. In current implementation, only image
components with spatial coherence (e.g. reflectors) generate
wavefields with spatial coherence. Diffractions, for example, do not
fit this description and, thus, are removed from the image by the
imaging condition. This can be seen both as a feature or as a drawback
depending on the type of imaging target.

% ------------------------------------------------------------
\section{Conclusions}
Conventional imaging conditions based on cross-correlation of
extrapolated wavefields do not take into account the local spatial
coherence of reflection events. Events are matched based on their
propagation times, which leads to cross-talk between unrelated
events. The stereographic imaging condition introduced in this paper
operates on seismic wavefields that are first decomposed function of
their local slope in space and time. Events are matched based on two
parameters (time and local slope), which separates unrelated events
and eliminates cross-talk. Higher imaging accuracy is achieved at the
expense of larger computational cost. Applications include
simultaneous imaging of different seismic experiments (shots),
multiple attenuation in the imaging condition, etc.

\section{Acknowledgment}
This work is supported by the sponsors of the Center for Wave
Phenomena at Colorado School of Mines.

% ------------------------------------------------------------
\bibliographystyle{seg}
\bibliography{SEG,PCS,MISC}

