\input{pcsmacros}

\pgfdeclareimage[height=1.0in]{logo}{Fig/kaust}

\title[]{Learning Madagascar:}
\subtitle{on a per need basis}
\author{Tariq Alkhalifah} 
\institute{
Seismic Analysis Group (SWAG) \\
KAUST \\
swag.kaust.edu.sa
}
\date{}
%\logo{Fig/swag_logo}
% ------------------------------------------------------------
\mode<beamer> { \cwpcover }

\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqa{\begin{eqnarray}}
\def\eeqa{\end{eqnarray}}

% ------------------------------------------------------------
\inputdir{XFig}
% ------------------------------------------------------------

\begin{frame} 
\frametitle{From the net}

Q: What is the difference between a Ph.D. in mathematics and a large pizza?
A: A large pizza can feed a family of four...  \\
-------------------------------\\
A mathematician, an engineer, and a computer scientist are vacationing together. They are riding in a car, enjoying the countryside, when suddenly the engine stops working.
The mathematician: "We came past a gas station a few minutes ago. Someone should go back and ask for help."
The engineer: "I should have a look at the engine. Perhaps, I can fix it."
The computer scientist: "Why don't we just open the doors, slam them shut, and see if everything works again?"  

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{The issue}

\big{
The seemingly complex makeup:
\begin{itemize}
\item LaTeX, python (scons????), and C.
\item The file system (where is everything?).
\item incomplete and not-up-to-date documentation.
\item Any info on the libraries? (C and Python)?
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{The objective}

\big{
\begin{itemize}
\item Getting from Madagascar what you need: even if we have to get dirty.
\item Example paper: Scanning for the anisotropy parameter $\eta$, soon to be published 
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} 

\frametitle{Paper: the issue}

\big{Uncertainty in anisotropic medium parameters in complex media: The trade-off between anisotropy and inhomogeneity}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Paper: scope}

\big{
\begin{itemize}
   \item Perturbation of the eikonal equation for small $\eta$
   \item Fast marching approach to solve the equations
   \item A homogeneous approximation
   \item A Marmousi example
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame}  \frametitle{Scanning for $\eta$}
  \plot{scanEta}{width=0.5\textwidth}{} 
\end{frame} 
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{First step: the paper template}

\begin{itemize}
   \item From the book directory, or one of your own papers
   \item Read the paper and see if you could form a good introduction from that paper.
   \item Copy it to your directory compile it (the whole directory)
   \item Remove unwanted examples and corresponding directories (compile again).
   \item Write your abstract (a road map).
\end{itemize}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{For the $\eta$ scan paper}

\big{
``A variational formulation of the fast marching eikonal solver'' \\
Sergey Fomel 
}

\big{book/sep/fmeiko}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{The coefficients of powers of $\eta$}
\big{
\beqa
v_v^2 \frac{\partial \tau _0}{\partial z} \frac{\partial \tau _i}{\partial z}+
v^2 \frac{\partial \tau _0}{\partial y} \frac{\partial \tau _i}{\partial y}+ \nonumber \\
v^2 \frac{\partial \tau _0}{\partial x} \frac{\partial \tau _i}{\partial x} =
f_i(x,y,z) \nonumber
\label{eqn:allorder}
\eeqa
with $i=1,2,3$.
}
\beqa
\tau(x,y,z) \approx \tau_{0} (x,y,z) + \tau_{1} (x,y,z) \eta +  \tau_{2} (x,y,z) \eta^{2} + \tau_{3} (x,y,z) \eta^{3} \nonumber
\eeqa
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Second step: An equivalent code}

\begin{itemize}
   \item Covers the dimensions of the input and output fields (also velocity if needed)
   \item Locate whether their is an example that runs it (search SConstruct)
   \item Copy the code (and all related files) to your directly and compile it
   \item fetch the example directory that runs it to your papers directory and run the example
   \item Delete unwanted parts and then compile it again (The art of deletion).
\end{itemize}
\big{Thus I used ``Meikonal.c''}

\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications 1}

\big{Meikonal.c}
\normalsize 
\lstinputlisting[firstline=1,lastline=6]
		{\RSFSRC/user/fomels/Meikonal.c}
\big{MeikEta.c}
\lstinputlisting[firstline=1,lastline=6]
		{\RSFSRC/user/tariq/MeikEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications 2}

\big{Meikonal.c}
\normalsize 
\lstinputlisting[firstline=20,lastline=25]
		{\RSFSRC/user/fomels/Meikonal.c}
\big{MeikEta.c}
\lstinputlisting[firstline=20,lastline=25]
		{\RSFSRC/user/tariq/MeikEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications 3}

\big{Meikonal.c}
\normalsize 
\lstinputlisting[firstline=28,lastline=33]
		{\RSFSRC/user/fomels/Meikonal.c}
\big{MeikEta.c}
\lstinputlisting[firstline=28,lastline=33]
		{\RSFSRC/user/tariq/MeikEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications 4}

\big{Meikonal.c}
\normalsize 
\lstinputlisting[firstline=56,lastline=57]
		{\RSFSRC/user/fomels/Meikonal.c}
\big{MeikEta.c}
\lstinputlisting[firstline=57,lastline=64]
		{\RSFSRC/user/tariq/MeikEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{The heart}

\big{MeikEta.c}
\lstinputlisting[firstline=157,lastline=167]
		{\RSFSRC/user/tariq/MeikEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications subroutine}

\big{fastmarch.c}
\normalsize 
\lstinputlisting[firstline=20,lastline=23]
		{\RSFSRC/user/fomels/fastmarch.c}
\big{fastEta.c}
\lstinputlisting[firstline=20,lastline=25]
		{\RSFSRC/user/tariq/fastEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Modifications subroutine}

\big{fastmarch.c}
\normalsize 
\lstinputlisting[firstline=20,lastline=23]
		{\RSFSRC/user/fomels/fastmarch.c}
\big{fastEta.c}
\lstinputlisting[firstline=20,lastline=25]
		{\RSFSRC/user/tariq/fastEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Choices}

\big{fastmarch.c}
\normalsize 
\lstinputlisting[firstline=57,lastline=58]
		{\RSFSRC/user/fomels/fastmarch.c}
\big{fastEta.c}
\lstinputlisting[firstline=678,lastline=679]
		{\RSFSRC/user/tariq/fastEta.c}
		
\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Complex examples}

\begin{itemize}
   \item Go to the Data directory under book
   \item Pick the example you need 2-D versus 3-D and the message you want to deliver
   \item copy that directory to your papers directoy
   \item In my case, the Marmousi example
   \item Alternatively, you could find the examples in some of the reproducible papers
\end{itemize}

\end{frame}
\cwpnote{}

\inputdir{marm}
% ------------------------------------------------------------
\begin{frame} \frametitle{Marmousi Result}

\plot{marmousi}{width=0.8\textwidth}{}
\vspace{1in}
$\eta=0.1$
 \end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{A scan for $\eta$}

\plot{moveout}{width=0.8\textwidth}{}

$\eta=0.0-0.5$
 \end{frame}
\cwpnote{}


\inputdir{.}

% ------------------------------------------------------------
\begin{frame} \frametitle{Documentation}

\big{
Madagascar Programming Reference Manual}
\big{courtesy of SWAG}
\big{RSFSRC/book/rsf/manual}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Content}

\begin{itemize}
   \item Covers all available data types and subroutines under rsf.h
   \item Includes a description (beyond what was given by the developer)
   \item It organizes them in terms of usage and purpose
   \item we plan to have the manual get built automatically to include updates in the subroutine
\end{itemize}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Content}\
\vspace{-0.2in}

\begin{itemize}
\item \emph{An example: Finite-Difference modeling}
\item \emph{Data types}\label{sec:datatypes}
\item \emph{Preparing for input}\label{sec:input}
\item \emph{Operations with RSF files}\label{sec:files}
\item \emph{Error handling}\label{sec:error}
\item \emph{Linear operators}\label{sec:lop}
\item \emph{Data analysis}\label{sec:analysis}
\item \emph{Filtering}\label{sec:filter}
\item \emph{Solvers}\label{sec:solvers}
\item \emph{Interpolation}\label{sec:interpolation}
\item \emph{Smoothing}\label{sec:smoothing}
\item \emph{Ray tracing}\label{sec:ray}
\item \emph{General tools}\label{sec:general}
\item \emph{Geometry}\label{sec:geometry}
\item \emph{Miscellaneous}\label{sec:misc}
\item \emph{System}\label{sec:system}
\end{itemize}
\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame} \frametitle{Pointers}

\big{
\begin{itemize}
   \item Be patient, do not give up
   \item Use rsf-user@lists.sourceforge.net
   \item SConstruct controls everything, try, at least, to understand it
   \item You could always run RSF like SU
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{Final remarks}

\big{
\begin{itemize}
   \item Make things simple
   \item Get to know Madagascar
   \item Always compile (makes error search easier)
   \item Reproducible is good (very good)
   \item Love thy neighbor $\rightarrow$ contribute
\end{itemize}
}

\end{frame}
\cwpnote{}


% ------------------------------------------------------------
\begin{frame}

\big{I thank the supporters of SWAG}

\vfill

\begin{center}
\plot{swag_logo}{width=0.3\textwidth}{}
%\pgfuseimage{../Fig/swag_logo}
\end{center}

\big{\url{http://swag.kaust.edu.sa}}

\end{frame}

% ------------------------------------------------------------
\begin{frame} \frametitle{Madagascar Challenges}

\big{
\begin{itemize}
   \item A document for developers to encourage best practices
   \item This includes min. documentation and examples for system codes
   \item A steering committee???
   \item Accept sponsorship? to cover some improvement costs?
\end{itemize}
}

\end{frame}
\cwpnote{}

% ------------------------------------------------------------
\begin{frame} \frametitle{The Madagascar philosophy}

\big{
\begin{itemize}
   \item Democracy? Do we have really have that?
   \item Capitalist? It is free!!
   \item Socialist? Equal distribution regardless of work
   \item Helpful? 
\end{itemize}
}

\end{frame}
\cwpnote{}


%% 
 % contest: nicest impulse response at z=7km, x=14km
 % beauty: 1...100 (nicest image, i.e. fewest artifacts)
 % cost:   1...100 (highest cost, i.e. most receivers)
 % find the highest b/c score
 %%
