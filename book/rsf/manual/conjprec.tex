\section[CG with preconditioning (conjprec.c)]{Conjugate-gradient with preconditioning (conjprec.c)}




\subsection{{sf\_conjprec\_init}}
Initializes the conjugate gradient solver, that is, it sets the required variables and allocates the required memory.

\subsubsection*{Call}
\begin{verbatim}sf_conjprec_init(int nx, nr, eps, tol, verb, hasp0;\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjprec_init(int nx     /* preconditioned size */, 
                      int nr     /* residual size */, 
                      float eps  /* scaling */,
                      float tol  /* tolerance */, 
                      bool verb  /* verbosity flag */, 
                      bool hasp0 /* if has initial model */)
/*< solver constructor >*/ 
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt hasp01]
   \setlength\itemsep{0pt}
   \item[nx1]    the size of the preconditioned data (\texttt{int}). 
   \item[nr1]    size of the residual (\texttt{int}). 
   \item[eps]    the scaling parameter (\texttt{float}). 
   \item[tol1]   tolerance to the error in the solution  (\texttt{float}). 
   \item[verb1]  verbosity flag (\texttt{bool}). 
   \item[hasp01] if there is a initial model (\texttt{bool}).  
\end{desclist}



\subsection{{sf\_conjprec\_close}}
Frees the allocated space for the conjugate gradient solver.

\subsubsection*{Call}
\begin{verbatim}sf_conjprec_close();\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjprec_close(void)
/*< Free allocated space >*/
{
   ...
}
\end{verbatim}




\subsection{{sf\_conjprec}}
Applies the conjugate grad\index{conjugate gradient!with preconditioning}ient method after preconditioning to the input data.

\subsubsection*{Call}
\begin{verbatim}
void sf_conjprec(oper, prec, p, x, dat, niter);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjprec(sf_operator oper  /* linear operator */, 
                 sf_operator2 prec /* preconditioning */, 
                 float* p          /* preconditioned */, 
                 float* x          /* model */, 
                 const float* dat  /* data */, 
                 int niter         /* number of iterations */)
/*< Conjugate gradient solver with preconditioning >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt niter]
   \setlength\itemsep{0pt}
   \item[oper]  the operator (\texttt{sf\_operator}). 
   \item[prec]  preconditioning operator (\texttt{sf\_operator2}). 
   \item[p]     the preconditioned data (\texttt{float*}).  
   \item[x]     model (\texttt{float*}).  
   \item[dat]   the data (\texttt{const float*}).  
   \item[niter] number of iterations (\texttt{int}).  
\end{desclist}




