\section{Banded matrix solver (banded.c)}\label{sec:banded.c}




\subsection{{sf\_banded\_init}}
Initializes an object of type \texttt{sf\_bands} for the banded matrix, that is, it allocates the required spaces and defines initializes the variables.


\subsubsection*{Call}
\begin{verbatim}slv = sf_banded_init (n, band);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
sf_bands sf_banded_init (int n    /* matrix size */, 
                         int band /* band size */)
/*< initialize >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt band]
   \setlength\itemsep{0pt}
   \item[n]    size of the banded matrix (\texttt{int}). 
   \item[band] size of the band (\texttt{int}).  
\end{desclist}

\subsubsection*{Output}
\begin{desclist}{\tt }{\quad}[\tt slv]
   \setlength\itemsep{0pt}
   \item[slv] an object of type \texttt{sf\_bands}.
\end{desclist}




\subsection{{sf\_banded\_define}}
Defines the banded matrix.

\subsubsection*{Call}
\begin{verbatim}sf_banded_define (slv, diag, offd);\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt offd]
   \setlength\itemsep{0pt}
   \item[slv]  an object of type \texttt{sf\_bands}. 
   \item[diag] diagonal entries in the matrix (\texttt{float**}).  
   \item[offd] off-diagonal entries in the matrix (\texttt{float**}).  
\end{desclist}

\subsubsection*{Definition}
\begin{verbatim}
void sf_banded_define (sf_bands slv, 
                       float* diag  /* diagonal [n] */, 
                       float** offd /* off-diagonal [band][n] */)
/*< define the matrix >*/
{
   ...
}
\end{verbatim}




\subsection{{sf\_banded\_const\_define}}
Defines a banded matrix with constant value in the diagonal.

\subsubsection*{Call}
\begin{verbatim}sf_banded_const_define (slv, diag, offd);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_banded_const_define (sf_bands slv, 
                             float diag        /* diagonal */, 
                             const float* offd /* off-diagonal [band] */)
/*< define matrix with constant diagonal coefficients >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt offd]
   \setlength\itemsep{0pt}
   \item[slv]  an object of type \texttt{sf\_bands}. 
   \item[diag] diagonal entries in the matrix (\texttt{float**}).  
   \item[offd] off-diagonal entries in the matrix (\texttt{float**}).  
\end{desclist}




\subsection{{sf\_banded\_const\_define\_reflect}}
Defines the banded matrix with constant diagonal values for the reflecting boundary conditions.

\subsubsection*{Call}
\begin{verbatim}sf_banded_const_define_reflect (slv, diag, offd);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_banded_const_define_reflect (sf_bands slv, 
                                     float diag        /* diagonal */, 
                                     const float* offd /* off-diagonal [band] */)
/*< define matrix with constant diagonal coefficients  
    and reflecting b.c. >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt ]
   \setlength\itemsep{0pt}
   \item[slv]  an object of type \texttt{sf\_bands}. 
   \item[diag] diagonal entries in the matrix (\texttt{float**}).  
   \item[offd] off-diagonal entries in the matrix (\texttt{float**}).  

\end{desclist}




\subsection{{sf\_banded\_solve}}
Inverts the banded matrix.

\subsubsection*{Call}
\begin{verbatim}sf_banded_solve (slv, b);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_banded_solve (const sf_bands slv, float* b)
/*< invert (in place) >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt slv]
   \setlength\itemsep{0pt}
   \item[slv] an object of type \texttt{sf\_bands}. Must be of type \texttt{const sf\_bands}   
   \item[b]   the inverted matrix values (\texttt{float*}).  
\end{desclist}




\subsection{{sf\_banded\_close}}
Frees the space allocated for the \texttt{sf\_bands} object.

\subsubsection*{Call}
\begin{verbatim}sf_banded_close (slv);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_banded_close (sf_bands slv)
/*< free allocated storage >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt ]
   \setlength\itemsep{0pt}
   \item[slv] an object of type \texttt{sf\_stack}.
\end{desclist}





