\section{Sharpening inversion added Bregman iteration (sharpinv.c)}




\subsection{{sf\_csharpinv}}
Performs the sharp inversion to estimate the model from the data, for complex numbers.

\subsubsection*{Call}
\begin{verbatim}
sf_csharpinv(oper, scale, niter, ncycle, perc, verb, nq, np, qq, pp);
\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_csharpinv(sf_coperator oper /* inverted operator */, 
                  float scale       /* extra operator scaling */,
                  int niter         /* number of outer iterations */,
                  int ncycle        /* number of iterations */,
                  float perc        /* sharpening percentage */,
                  bool verb         /* verbosity flag */,
                  int nq, int np    /* model and data size */,
                  sf_complex *qq    /* model */, 
                  sf_complex *pp    /* data */)
/*< sharp inversion for complex-valued operators >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt ncycle]
   \setlength\itemsep{0pt}
   \item[oper]   the inverted operator (\texttt{sf\_operator}). 
   \item[scale]  extra operator scaling (\texttt{float}). 
   \item[niter]  number of outer iterations (\texttt{int}). 
   \item[ncycle] number of iterations (\texttt{int}). 
   \item[perc]   sharpening percentage (\texttt{float}). 
   \item[verb]   verbosity flag (\texttt{bool}). 
   \item[nq]     size of the model (\texttt{int}).
   \item[np]     size of the data (\texttt{int}). 
   \item[qq]     the model. Must be of type \	texttt{sf\_complex*}.
   \item[pp]     the data (\texttt{sf\_complex*}).
\end{desclist}




\subsection{{sf\_sharpinv}}
Performs the sharp inversion to estimate the model from the data.

\subsubsection*{Call}
\begin{verbatim}
void sf_sharpinv(oper, scale, niter, ncycle, perc, verb, nq, np, qq, pp);
\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_sharpinv(sf_operator oper  /* inverted operator */, 
                 float scale       /* extra operator scaling */,
                 int niter         /* number of outer iterations */,
                 int ncycle        /* number of iterations */,
                 float perc        /* sharpening percentage */,
                 bool verb         /* verbosity flag */,
                 int nq, int np    /* model and data size */,
                 float *qq         /* model */, 
                 float *pp         /* data */)
/*< sharp inversion for real-valued operators >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt ncycle]
   \setlength\itemsep{0pt}
   \item[oper]   the inverted operator (\texttt{sf\_operator}). 
   \item[scale]  extra operator scaling (\texttt{float}). 
   \item[niter]  number of outer iterations (\texttt{int}). 
   \item[ncycle] number of iterations (\texttt{int}). 
   \item[perc]   sharpening percentage (\texttt{float}). 
   \item[verb]   verbosity flag (\texttt{bool}). 
   \item[nq]     size of the model (\texttt{int}).
   \item[np]     size of the data (\texttt{int}). 
   \item[qq]     the model (\texttt{float*}).
   \item[pp]     the data (\texttt{float*}).
\end{desclist}



