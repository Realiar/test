\section{Conjugate-gradient with shaping regularization (conjgrad.c)}




\subsection{{sf\_conjgrad\_init}}
Initializes the conjugate grad\index{conjugate gradient!solver}ient solver by initializing the required variables and allocating the required space.

\subsubsection*{Call}
\begin{verbatim}sf_conjgrad_init (np, nx, nd, nr, eps, tol, verb, hasp0);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjgrad_init(int np1     /* preconditioned size */, 
                      int nx1     /* model size */, 
                      int nd1     /* data size */, 
                      int nr1     /* residual size */, 
                      float eps1  /* scaling */,
                      float tol1  /* tolerance */, 
                      bool verb1  /* verbosity flag */, 
                      bool hasp01 /* if has initial model */) 
/*< solver constructor >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt hasp01]
   \setlength\itemsep{0pt}
   \item[np1]    the size of the preconditioned data (\texttt{int}). 
   \item[nx1]    size of the model (\texttt{int}). 
   \item[nd1]    size of the data (\texttt{int}). 
   \item[nr1]    size of the residual (\texttt{int}). 
   \item[eps1]   the scaling parameter (\texttt{float}). 
   \item[tol1]   tolerance to the error in the solution  (\texttt{float}). 
   \item[verb1]  verbosity flag (\texttt{bool}). 
   \item[hasp01] if there is a initial model (\texttt{bool}).  
\end{desclist}




\subsection{{sf\_conjgrad\_close}}
Frees the space allocated for the conjugate gradient solver by \texttt{sf\_conjgrad\_init}.

\subsubsection*{Definition}
\begin{verbatim}
sf_conjgrad_close();\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjgrad_close(void) 
/*< Free allocated space >*/
{
   ...
}
\end{verbatim}




\subsection{{sf\_conjgrad}}
Applies the conjugate gradient solver with the shaping filter to the input data.

\subsubsection*{Definition}
\begin{verbatim}sf_conjgrad (prec, oper, shape, p, x, dat, niter);\end{verbatim}

\subsubsection*{Definition}
\begin{verbatim}
void sf_conjgrad(sf_operator prec  /* data preconditioning */, 
                 sf_operator oper  /* linear operator */, 
                 sf_operator shape /* shaping operator */, 
                 float* p          /* preconditioned model */, 
                 float* x          /* estimated model */, 
                 float* dat        /* data */, 
                 int niter         /* number of iterations */) 
/*< Conjugate gradient solver with shaping >*/
{
   ...
}
\end{verbatim}

\subsubsection*{Input parameters}
\begin{desclist}{\tt }{\quad}[\tt shape]
   \setlength\itemsep{0pt}
   \item[prec]  preconditioning operator (\texttt{sf\_operator}). 
   \item[oper]  the operator (\texttt{sf\_operator}). 
   \item[shape] the shaping operator (\texttt{sf\_operator}). 
   \item[p]     the preconditioned model (\texttt{float*}).  
   \item[x]     estimated model  (\texttt{float*}).  
   \item[dat]   the data (\texttt{float*}).  
   \item[niter] number of iterations (\texttt{int}).  
\end{desclist}



