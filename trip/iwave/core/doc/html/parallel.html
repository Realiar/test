<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>IWAVECORE: Parallel Simulations with IWAVE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">IWAVECORE&#160;<span id="projectnumber">1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Parallel Simulations with IWAVE </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><p>IWAVE simulations can run in either serial (single thread) mode, or distributed (MPI) or shared-memory (OpenMP) parallel modes. Serial mode is the default. For more on installation of the parallel options, see the IWAVE <a href="../../../README.INSTALL">install </a> and <a href="../../../README.MAKE">build </a> notes.</p>
<p>Distributed mode supports either loop-level (domain decomposition) or task level (parallel shots) parallelism, or both simultaneously. </p>
<p><b>Cartesian domain decomposition via MPI</b>: defined by specifying the number of domains along each coordinate axis. </p>
<ul>
<li>
mpi_np1 = [int] [Default = 1] number of subdomains along axis 1 </li>
<li>
mpi_np2 = [int] [Default = 1] number of subdomains along axis 2 </li>
<li>
mpi_np3 = [int] [Default = 1].number of subdomains along axis 3 </li>
</ul>
<p>In domain decomposition mode, IWAVE divides regular rectangular simulation grids into a rectangular array of regular regular rectangular subgrids, of as nearly equal dimensions as possible. Thus mpi_np2=2 indicates that a 100 x 100 x 100 grid will be partitioned into two subgrids, each of size 100 x 50 x 100 (roughly - the actual number may be influenced by added ghost cells needed for data exchange at subdomain boundaries, as determined by scheme stenceils, or by PML or other boundary conditions). Setting mpi_np1=2, mpi_np2=2 will yield four domains of approximate size 50 x 50 x 100, and so on. The code currently makes no attempt to account for load imbalance, for instance, between PML and non-PML subgrids. The number of subdomains can only be set &gt; 1 in any direction if MPI parallelism is installed, and if the spatial dimension of the problem is at least the index of that direction - that is, the code exits with an error message if mpi_np3 &gt; 1 and the problem spatial dimnension is 1 or 2. The number of MPI processes specified in the command line or batch script must be at least the total number of domains = mpi_np1*mpi_np2*mpi_np3. </p>
<p><b>Task parallelism</b>, that is, simultaneous simulation of several shots: toggled by a nonzero value of the partask parameter:</p>
<ul>
<li>
partask = [int] [Default = 0] if set, load as many as possible given the size of MPI_COMM_WORLD, <em> but at most partask</em>, simulations. </li>
</ul>
<p>For example, if mpi_np1=mpi_np2=mpi_np3=2 and 32 processors are assigned to the simulation, then setting partask to be at least 4 will cause up to 4 shots to be loaded at a time, simulated, and written to the output file, until no shots remain to be simulated. If partask is less than 4, but greater than zero, then partask simulations will be loaded. If 33 processors were assigned and partask is at least 4, IWAVE will still load 4 shots at a time, but the 33rd process will be flagged as inactive, that is, not used in the simulation. If 31 processors are assigned and partask is at least three, then IWAVE loads 3 shots at a time and flags the 25th-31st processes as inactive. </p>
<p>It is possible to use domain decomposition without task parallelism (partask=0 or number of processes less than twice the number of domains), or task parallelism without domain decomposition (partask &gt; 0, mpi_np1=mpi_np2=mpi_np3=1), or both simultaneously. </p>
<p>Note that the user must define an upper bound (partask) on the number of simultaneous simulations. The actual number will be the minimum of this user-defined upper bound and the maximum that can fit in MPI_WORLD_COMM. This user role is unavoidable, as the assignment of processes takes place before the simulation geometry data is read. </p>
<p><b>Threaded parallelism via OpenMP</b>: Regulated by </p>
<ul>
<li>
omp_nt = [int] [Default = 1] number of OpenMP threads - significant only if OpenMP is enabled.during install </li>
</ul>
<p>Use requires that stencil code be instrumented with appropriate pragmas. Have kept this option available for possible future use. With current CPU designs, multithreaded execution of standard finite difference stencils does not seem to result in useful speedup. </p>
</div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Dec 3 2014 12:36:46 for IWAVECORE by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
