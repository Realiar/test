/* This file is automatically generated. DO NOT EDIT! */

#ifndef _wexlsr_h
#define _wexlsr_h


#include <math.h>
#include <rsf.h>


#include "wexfft.h"
#include "wexutl.h"


wexlsr3d wexlsr_init(wexcub3d cub,
                      int      px,
                      int      py,
                      float  dsmax
    );
/*< initialize >*/


void wexlsr_close(wexcub3d cub,
                  wexlsr3d lsr);
/*< free allocated storage >*/


void kweight(wexcub3d cub,
             wexlsr3d lsr,
             float **bs,
             float   wo  /* frequency */
);
/*< k-domain weight >*/


/*------------------------------------------------------------*/
void wexlsr_s2w(
    sf_complex    w /* frequency */,
    sf_complex **bw /* background   wavefield */,
    wexcub3d    cub,
    wexlsr3d    lsr,
    wexslo3d    slo,
    sf_complex **pw /* perturbation wavefield */,
    sf_complex **ps /* perturbation slowness  */,
    int          iz,
    int      ompith
    );
/*< linear scattering operator (forward) >*/


/*------------------------------------------------------------*/
void wexlsr_w2s(
    sf_complex    w /* frequency */,
    sf_complex **bw /* background   wavefield */,
    wexcub3d    cub,
    wexlsr3d    lsr,
    wexslo3d    slo,
    sf_complex **pw /* perturbation wavefield */,
    sf_complex **ps /* perturbation slowness  */,
    int          iz,
    int      ompith
    );
/*< linear scattering operator (adjoint) >*/

#endif
